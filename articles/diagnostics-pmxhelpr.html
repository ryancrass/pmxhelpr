<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Standard Model Diagnostics • pmxhelpr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Standard Model Diagnostics">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pmxhelpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/diagnostics-pmxhelpr.html">Standard Model Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/eda-pmxhelpr.html">Exploratory Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/vpc-exact-bins.html">VPC Plots with Exact Bins</a></li>
    <li><a class="dropdown-item" href="../articles/vpc-obs-quant-blq-cens.html">VPC Plots with BLQ Censoring</a></li>
    <li><a class="dropdown-item" href="../articles/vpc-plot-aesthetics.html">VPC Plot Aesthetics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ryancrass/pmxhelpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Standard Model Diagnostics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ryancrass/pmxhelpr/blob/v0.3.3/vignettes/diagnostics-pmxhelpr.Rmd" class="external-link"><code>vignettes/diagnostics-pmxhelpr.Rmd</code></a></small>
      <div class="d-none name"><code>diagnostics-pmxhelpr.Rmd</code></div>
    </div>

    
    
<p>This vignette will demonstrate <code>pmxhelpr</code> functions for
generating standard model diagnostics.</p>
<p>First, we will load the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span>, rmarkdown.html_vignette.check_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ryancrass/pmxhelpr" class="external-link">pmxhelpr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/" class="external-link">Hmisc</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>For this vignette, we will generate model diagnostics for a PK model
(<code>model</code>) fit to <code>data_sad</code> dataset using the
<code>data_sad_pkfit</code> dataset internal to <code>pmxhelpr</code>.
We can take a quick look at the dataset using <code><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse()</a></code>
from the dplyr package. Dataset definitions can also be viewed by
calling <code><a href="../reference/data_sad_pkfit.html">?data_sad_pkfit</a></code>, as one would to view the
documentation for a package function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">data_sad_pkfit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 25</span></span>
<span><span class="co">#&gt; $ LINE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>9<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>12<span style="color: #949494;">, </span>13<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>16<span style="color: #949494;">, </span>17<span style="color: #949494;">, </span>18<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ID      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ TIME    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00<span style="color: #949494;">, </span>0.00<span style="color: #949494;">, </span>0.48<span style="color: #949494;">, </span>0.81<span style="color: #949494;">, </span>1.49<span style="color: #949494;">, </span>2.11<span style="color: #949494;">, </span>3.05<span style="color: #949494;">, </span>4.14<span style="color: #949494;">, </span>5.14<span style="color: #949494;">, </span>7.81<span style="color: #949494;">, </span>12…</span></span>
<span><span class="co">#&gt; $ NTIME   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>0.5<span style="color: #949494;">, </span>1.0<span style="color: #949494;">, </span>1.5<span style="color: #949494;">, </span>2.0<span style="color: #949494;">, </span>3.0<span style="color: #949494;">, </span>4.0<span style="color: #949494;">, </span>5.0<span style="color: #949494;">, </span>8.0<span style="color: #949494;">, </span>12.0<span style="color: #949494;">, </span>16.0<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ NDAY    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ DOSE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10…</span></span>
<span><span class="co">#&gt; $ AMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>10<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span>…</span></span>
<span><span class="co">#&gt; $ EVID    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ODV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>2.02<span style="color: #949494;">, </span>4.02<span style="color: #949494;">, </span>3.50<span style="color: #949494;">, </span>7.18<span style="color: #949494;">, </span>9.31<span style="color: #949494;">, </span>12.46<span style="color: #949494;">, </span>13.43<span style="color: #949494;">, </span>12.11<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ LDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>0.7031<span style="color: #949494;">, </span>1.3913<span style="color: #949494;">, </span>1.2528<span style="color: #949494;">, </span>1.9713<span style="color: #949494;">, </span>2.2311<span style="color: #949494;">, </span>2.5225<span style="color: #949494;">, </span>2.…</span></span>
<span><span class="co">#&gt; $ CMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ MDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ BLQ     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ LLOQ    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ FOOD    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ SEXF    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ RACE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ AGEBL   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25…</span></span>
<span><span class="co">#&gt; $ WTBL    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82…</span></span>
<span><span class="co">#&gt; $ SCRBL   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.…</span></span>
<span><span class="co">#&gt; $ CRCLBL  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>12…</span></span>
<span><span class="co">#&gt; $ USUBJID <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "STUDYNUM-SITENUM-1"<span style="color: #949494;">, </span>"STUDYNUM-SITENUM-1"<span style="color: #949494;">, </span>"STUDYNUM-SITENUM-…</span></span>
<span><span class="co">#&gt; $ PART    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part …</span></span>
<span><span class="co">#&gt; $ IPRED   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000000<span style="color: #949494;">, </span>0.0000000000<span style="color: #949494;">, </span>0.2399127105<span style="color: #949494;">, </span>0.5809776251<span style="color: #949494;">, </span>1.4434…</span></span>
<span><span class="co">#&gt; $ PRED    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000000<span style="color: #949494;">, </span>0.0000000000<span style="color: #949494;">, </span>1.0373644222<span style="color: #949494;">, </span>2.4699025938<span style="color: #949494;">, </span>5.8692…</span></span></code></pre></div>
<p>This dataset contains two additional variables relative to the
observed dataset used in model development (<code>data_sad</code>):</p>
<ul>
<li>
<code>PRED</code>: population model predicted values accounting only
for fixed effects (THETAs)</li>
<li>
<code>IPRED</code>: individual model predicted values accounting for
fixed effects (THETAs) and level 1 (inter-individual) random effects
(ETAs)</li>
</ul>
<p>Let’s add some additional derived character variables, which may be
useful for plotting.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">data_sad_pkfit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>FoodStatus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">FOOD</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">"Fasted"</span>, <span class="st">"Fed"</span><span class="op">)</span>, </span>
<span>         DoseGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">" mg "</span>, <span class="va">FoodStatus</span><span class="op">)</span>, </span>
<span>         DoseGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">DoseGroup</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10 mg Fasted"</span>, <span class="st">"50 mg Fasted"</span>, <span class="st">"100 mg Fasted"</span>, <span class="st">"100 mg Fed"</span>, </span>
<span>                                                  <span class="st">"200 mg Fasted"</span>, <span class="st">"400 mg Fasted"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="population-overlay-goodness-of-fit-plots">Population Overlay Goodness of Fit Plots<a class="anchor" aria-label="anchor" href="#population-overlay-goodness-of-fit-plots"></a>
</h2>
<div class="section level3">
<h3 id="overview-of-plot_popgof">Overview of <code>plot_popgof</code><a class="anchor" aria-label="anchor" href="#overview-of-plot_popgof"></a>
</h3>
<p><code>pmxhelpr</code> includes a function for generating population
overlay goodness-of-fit (GOF) plots for model evaluation:
<code>plot_popgof</code>.</p>
<p><em>NOTE</em> <code>plot_popgof</code> inherits dataset variable
handling functionality and arguments from
<code>df_mrgsim_replicate</code>.</p>
<p>Variable processing requires specification of two named lists of time
and output variables:</p>
<ul>
<li>
<code>time_vars</code>: This argument provides a named vector of
actual and nominal time variables. <code>NTIME</code> must be an exact
binning variable.
<ul>
<li>Default is: c(<code>TIME</code>=<code>"TIME"</code>,
<code>NTIME</code>=<code>"NTIME"</code>).</li>
</ul>
</li>
<li>
<code>output_vars</code> This argument provides a named vector of
input (observations) and output (model prediction) variables.
<ul>
<li>Default is: c(<code>PRED</code>= <code>"PRED"</code>,
<code>IPRED</code> = <code>"IPRED"</code>, <code>DV</code>=
<code>"DV"</code>).</li>
</ul>
</li>
</ul>
<p>The example dataset <code>data_sad_pkfit</code> only differs from
these defaults in the variable nname for the dependenrt variable,
<code>"ODV"</code>. Thus, the most basic population GOF plot can be
obtained with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-1.png" width="576"></p>
<p>The pooled analysis population includes multiple dose levels in a
single plot, which is probably not optimal as a population PK model
diagnostic. A better minimal plot representation of these data can be
obtained by dose-normalizing and stratifying by study part to separate
out the fast and food effect portions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, dosenorm <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Dose-normalized Conc. (ng/mL)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dn-1.png" width="576"></p>
<p>Although, generally population goodness-of-fit plots are stratified
by study design (extrinsic) factors (e.g., Dose and Food Status) in
order to assess the adequacy of model fit in each unique study
condition.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-1.png" width="576"></p>
<p><em>NOTE</em> <code>plot_popgof</code> plot aesthetic functionality
from <code>plot_dvtime</code>.</p>
<p>This vignette will assume familiarity with the Exploratory Data
Analysis Vignette and <code>plot_dvtime</code>. The arguments and
functionality inherited from <code>plot_dvtime</code> will not be
reviewed in detail here, except where critical to interpretation of
model diagnostics.</p>
</div>
<div class="section level3">
<h3 id="plot-elements-and-colors">Plot Elements and Colors<a class="anchor" aria-label="anchor" href="#plot-elements-and-colors"></a>
</h3>
<p>There is only one new argument to <code>plot_popgof</code> that is
not present in <code>df_mrgsim_replicate</code> or
<code>plot_dvtime</code>. This argument is <code>output_colors</code>, a
named vector of pre-defined plot element and color pairs:</p>
<ul>
<li><code>PRED= "red"</code></li>
<li>
<code>IPRED</code>=<code>"green"</code>,</li>
<li>
<code>DV</code>=<code>"blue"</code>.</li>
<li>
<code>OBS</code>=<code>"darkgrey"</code>
</li>
</ul>
<p>The default plot elements are:</p>
<ul>
<li>
<code>PRED</code> - summary statistics for central tendency in the
population model predictions (<code>output_vars["PRED"]</code>)</li>
<li>
<code>IPRED</code> = summary statistics for central tendency in the
individual model predictions (<code>output_vars["IPRED"]</code>)</li>
<li>
<code>OBS</code> = observed data points for the dependent variable
(<code>output_vars["DV"]</code>)</li>
<li>
<code>DV</code> = summary statistics for central tendency (+/-
variability) in the dependent variable
(<code>output_vars["DV"]</code>)</li>
</ul>
<p><code>OBS</code> and <code>DV</code> represent the same data and both
map back to the variable in <code>data</code> specified in
<code>output_vars["DV"]</code>. They are differentiated only to allow
visual distinction between individual observation concentration data and
summary statistics of observed and model-predicted concentration
data.</p>
<p>If one wanted to clarify that all the data mapping back to the
dataset variable specified in <code>output_vars["DV]</code> with color,
then the default for <code>output_colors["OBS"]</code> can be updated to
to blue to align with <code>DV</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, output_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>OBS <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-blue-1.png" width="576"></p>
<p>Alternatively, the observed data points could be removed with only
the summary metrics plotted. Notice how different this plot appears when
only visualizing central tendency!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, obs_dv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-noobs-1.png" width="576"></p>
<p>A better plot that still emphasizes central tendency, but includes
some visualization of variability in the observed data, could also be
obtained by specifying one of ““.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, obs_dv <span class="op">=</span> <span class="cn">FALSE</span>, cent <span class="op">=</span> <span class="st">"median_iqr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-noobs-mediqr-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="specifying-the-central-tendency">Specifying the Central Tendency<a class="anchor" aria-label="anchor" href="#specifying-the-central-tendency"></a>
</h3>
<p><code>plot_popgof</code> (and <code>plot_dvtime</code>) uses the
<code>stat_summary</code> function from <code>ggplot2</code> to
calculate and plot the central tendency measures and error bars. The
summary statistics calculated are specified by the <code>cent</code>
argument. Options include:</p>
<ul>
<li>
<code>"mean"</code> = arithmetic mean (linear y-axis), geometric
mean (log y-axis)</li>
<li>
<code>"median"</code> = median (50th percentile)</li>
<li>
<code>"mean_sdl"</code> = arithmetic mean +/- arithmetic SD (linear
y-axis), geometric mean +/- geometric SC (log y-axis)</li>
<li>
<code>"median_iqr"</code> = median +/- interquartile range (25th to
75th percentiles)</li>
</ul>
<p>Variability statistics (SD, IQR) are plotted for the observed data
when requested and only the central tendency measures are calculated and
returned for model predictions (PRED, IPRED).</p>
<p>An often overlooked feature of <code>stat_summary</code>, is that it
calculates the summary statistics <em>after</em> any transformations to
the data performed by changing the scales. This means that when
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10()</a></code> is applied to the plot, the data are
log-transformed for plotting and the central tendency measure returned
with <code>"mean"</code> is the <em>geometric mean</em>.</p>
<p>If the <code>log_y</code> argument is used to generate semi-log plots
along with <code>show_captions = TRUE</code>, then the caption will
delineate where arithmetic and geometric means are being returned.</p>
<p>On the linear scale, the <code>"mean_sdl"</code> option produces
unrealistic error bars that cross zero given the small sample size,
variability, and log-normal distribution of concentration-time data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span> ,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-meansd-1.png" width="576"></p>
<p>However, when transformed to a semi-log scale with
<code>log_y = TRUE</code>, the error bars now reflect the geometric
standard deviation and are displayed correctly for lognormally
distributed data and the caption updates to reflect this.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-meansd-logy-1.png" width="576"></p>
<p>The caption will <em>NOT</em> update if a new axis is added to the
plot object outside of <code>plot_popgof</code> with
<code>scale_y_log10</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-logscale-1.png" width="576"></p>
<p>Transformation of the plot to a semi-log scale (log-scale y-axis
only) is recommended to be performed using the <code>log_y</code>
argument for the following benefits:</p>
<ul>
<li>Includes log tick marks on the y-axis</li>
<li>Updates the caption with the correct central tendency measure if
<code>show_captions = TRUE</code>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="defining-imputations-for-blq-data">Defining imputations for BLQ data<a class="anchor" aria-label="anchor" href="#defining-imputations-for-blq-data"></a>
</h3>
<p>There are some potential missfit in the model in the late terminal
phase, with the observed geometric mean values skewing higher than the
corresponding model predictions, particularly at lower doses. Is this
real? Let’s use imputation to assess the potential impact of the data
missing due to assay sensitivity on assessment of model
misspecification. The <code>loq_method</code> argument from
<code>plot_dvtime</code> was extended in <code>plot_popgof</code> to
also include model predictions.</p>
<p>Options are:</p>
<ul>
<li>
<code>0</code> : No handling. Plot input dataset <code>DV</code> vs
<code>TIME</code> as is. (default)</li>
<li>
<code>1</code> : Impute all BLQ data at <code>TIME</code> &lt;= 0 to
0 and all BLQ data at <code>TIME</code> &gt; 0 to 1/2 x
<code>loq</code>. Useful for plotting concentration-time data with some
data BLQ on the linear scale</li>
<li>
<code>2</code> : Impute all BLQ data at <code>TIME</code> &lt;= 0 to
1/2 x <code>loq</code> and all BLQ data at <code>TIME</code> &gt; 0 to
1/2 x <code>loq</code>.</li>
</ul>
<p>The <code>loq</code> argument species the value of the LLOQ. The
<code>loq</code> argument must be specified when <code>loq_method</code>
is <code>1</code> or <code>2</code>, but can be <code>NULL</code>
<em>if</em> the variable <code>LLOQ</code> is present in the
dataset.</p>
<p>Let’s take a look at our data stratified by dosing regimen. In
general, it is good practice to use <code>loq_method = 1</code> for
linear scale plots and <code>loq_method = 2</code> for log-scale plots,
in which zero is not a valid value.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span><span class="st">"ODV"</span><span class="op">)</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, grp_dv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>, loq_method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-popgof-dosegrp-logy-loq2-1.png" width="576"></p>
<p>Interesting! It looks like the potential misspecification in the late
terminal phase was in fact an artifact in the observed profile due to
censoring of data below the LLOQ. This is a common finding in SAD
studies and is usually dose dependent and more apparent at lower doses
where a larger proportion of samples will be BLQ.</p>
</div>
</div>
<div class="section level2">
<h2 id="individual-concentration-time-plots">Individual Concentration-time plots<a class="anchor" aria-label="anchor" href="#individual-concentration-time-plots"></a>
</h2>
<p>The previous section provides an overview of how to generate
population overlay GOF plots using <code>plot_popgof</code>; however, we
can also use <code>plot_popgof</code> to generate subject-level
visualizations with a little pre-processing of the input dataset.</p>
<p>We can plot an individual subject by filtering the input dataset.
This could be extended generate plots for all individuals using
<code>for</code> loops, <code>lapply</code>, <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code>
functions, or other methods.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="co">#vector of unique subject ids</span></span>
<span><span class="va">n_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span> <span class="co">#count of unique subject ids</span></span>
<span><span class="va">plots_per_pg</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">n_pgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">n_ids</span><span class="op">/</span><span class="va">plots_per_pg</span><span class="op">)</span> <span class="co">#Total number of pages needed</span></span>
<span></span>
<span><span class="va">plist</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_ids</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">plist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_popgof.html">plot_popgof</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">ID</span> <span class="op">==</span> <span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                            output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DV <span class="op">=</span> <span class="st">"ODV"</span><span class="op">)</span>, </span>
<span>                            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, </span>
<span>                            log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            grp_dv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                            show_caption <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">DoseGroup</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ID = "</span>, <span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_pgs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n_pg</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">i</span> <span class="op">&lt;-</span>  <span class="op">(</span><span class="va">n_pg</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">plots_per_pg</span><span class="op">+</span><span class="fl">1</span></span>
<span>      <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">n_pg</span><span class="op">*</span><span class="va">plots_per_pg</span></span>
<span>      <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">plist</span><span class="op">[</span><span class="va">i</span><span class="op">:</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-2.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-3.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-4.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-5.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-6.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-7.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-8.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span></code></pre>
<p><img src="diagnostics-pmxhelpr_files/figure-html/plot-indgofplots-9.png" width="576"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Crass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
