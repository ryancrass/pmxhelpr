<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exploratory Data Analysis • pmxhelpr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploratory Data Analysis">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pmxhelpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/diagnostics-pmxhelpr.html">Standard Model Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/eda-pmxhelpr.html">Exploratory Data Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/vpc-exact-bins.html">VPC Plots with Exact Bins</a></li>
    <li><a class="dropdown-item" href="../articles/vpc-obs-quant-blq-cens.html">VPC Plots with BLQ Censoring</a></li>
    <li><a class="dropdown-item" href="../articles/vpc-plot-aesthetics.html">VPC Plot Aesthetics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ryancrass/pmxhelpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Exploratory Data Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ryancrass/pmxhelpr/blob/v0.3.5/vignettes/eda-pmxhelpr.Rmd" class="external-link"><code>vignettes/eda-pmxhelpr.Rmd</code></a></small>
      <div class="d-none name"><code>eda-pmxhelpr.Rmd</code></div>
    </div>

    
    
<p>This vignette will demonstrate <code>pmxhelpr</code> functions for
exploratory data analysis.</p>
<p>First, we will load the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span>, rmarkdown.html_vignette.check_title <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ryancrass/pmxhelpr" class="external-link">pmxhelpr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://hbiostat.org/R/Hmisc/" class="external-link">Hmisc</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://humanpred.github.io/pknca/" class="external-link">PKNCA</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>For this vignette, we will perform exploratory data analysis on the
<code>data_sad</code> dataset internal to <code>pmxhelpr</code>. We can
take a quick look at the dataset using <code><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse()</a></code> from the
dplyr package. Dataset definitions can also be viewed by calling
<code><a href="../reference/data_sad.html">?data_sad</a></code>, as one would to view the documentation for a
package function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 23</span></span>
<span><span class="co">#&gt; $ LINE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>9<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>11<span style="color: #949494;">, </span>12<span style="color: #949494;">, </span>13<span style="color: #949494;">, </span>14<span style="color: #949494;">, </span>15<span style="color: #949494;">, </span>16<span style="color: #949494;">, </span>17<span style="color: #949494;">, </span>18<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ID      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ TIME    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00<span style="color: #949494;">, </span>0.00<span style="color: #949494;">, </span>0.48<span style="color: #949494;">, </span>0.81<span style="color: #949494;">, </span>1.49<span style="color: #949494;">, </span>2.11<span style="color: #949494;">, </span>3.05<span style="color: #949494;">, </span>4.14<span style="color: #949494;">, </span>5.14<span style="color: #949494;">, </span>7.81<span style="color: #949494;">, </span>12…</span></span>
<span><span class="co">#&gt; $ NTIME   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>0.5<span style="color: #949494;">, </span>1.0<span style="color: #949494;">, </span>1.5<span style="color: #949494;">, </span>2.0<span style="color: #949494;">, </span>3.0<span style="color: #949494;">, </span>4.0<span style="color: #949494;">, </span>5.0<span style="color: #949494;">, </span>8.0<span style="color: #949494;">, </span>12.0<span style="color: #949494;">, </span>16.0<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ NDAY    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>4<span style="color: #949494;">, </span>5<span style="color: #949494;">, </span>6<span style="color: #949494;">, </span>7<span style="color: #949494;">, </span>8<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ DOSE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10…</span></span>
<span><span class="co">#&gt; $ AMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>10<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span>…</span></span>
<span><span class="co">#&gt; $ EVID    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ ODV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>2.02<span style="color: #949494;">, </span>4.02<span style="color: #949494;">, </span>3.50<span style="color: #949494;">, </span>7.18<span style="color: #949494;">, </span>9.31<span style="color: #949494;">, </span>12.46<span style="color: #949494;">, </span>13.43<span style="color: #949494;">, </span>12.11<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ LDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>0.7031<span style="color: #949494;">, </span>1.3913<span style="color: #949494;">, </span>1.2528<span style="color: #949494;">, </span>1.9713<span style="color: #949494;">, </span>2.2311<span style="color: #949494;">, </span>2.5225<span style="color: #949494;">, </span>2.…</span></span>
<span><span class="co">#&gt; $ CMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ MDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ BLQ     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ LLOQ    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ FOOD    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ SEXF    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ RACE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ AGEBL   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25<span style="color: #949494;">, </span>25…</span></span>
<span><span class="co">#&gt; $ WTBL    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82.1<span style="color: #949494;">, </span>82…</span></span>
<span><span class="co">#&gt; $ SCRBL   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.87<span style="color: #949494;">, </span>0.…</span></span>
<span><span class="co">#&gt; $ CRCLBL  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>128<span style="color: #949494;">, </span>12…</span></span>
<span><span class="co">#&gt; $ USUBJID <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "STUDYNUM-SITENUM-1"<span style="color: #949494;">, </span>"STUDYNUM-SITENUM-1"<span style="color: #949494;">, </span>"STUDYNUM-SITENUM-…</span></span>
<span><span class="co">#&gt; $ PART    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part …</span></span></code></pre></div>
<p>We can see that this dataset is already formatted for modeling. It
contains NONMEM reserved variables (e.g., ID, TIME, AMT, EVID, MDV), as
well as, dependent variables of drug concentration in original units
(ODV) and natural logarithm transformed units (LDV).</p>
<p>In addition to the numeric variables, there are two character
variables: USUBJID and PART.</p>
<p>PART specifies the two study cohorts:</p>
<ul>
<li>Single Ascending Dose (SAD)</li>
<li>Food Effect (FE).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">PART</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Part 1-SAD" "Part 2-FE"</span></span></code></pre></div>
<p>This dataset also contains an exact binning variable:</p>
<ul>
<li>Nominal Time (NTIME).</li>
</ul>
<p>This variable represents the nominal time of sample collection
relative to first dose per study protocol whereas Actual Time (TIME)
represents the actual time the sample was collected.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Unique values of NTIME</span></span>
<span><span class="va">ntimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">NTIME</span><span class="op">)</span></span>
<span><span class="va">ntimes</span></span>
<span><span class="co">#&gt;  [1]   0.0   0.5   1.0   1.5   2.0   3.0   4.0   5.0   8.0  12.0  16.0  24.0</span></span>
<span><span class="co">#&gt; [13]  36.0  48.0  72.0  96.0 120.0 144.0 168.0</span></span>
<span></span>
<span><span class="co">##Comparison of number of unique values of NTIME and TIME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">NTIME</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 449</span></span></code></pre></div>
<div class="section level2">
<h2 id="population-concentration-time-plots">Population Concentration-time plots<a class="anchor" aria-label="anchor" href="#population-concentration-time-plots"></a>
</h2>
<div class="section level3">
<h3 id="overview-of-plot_dvtime">Overview of <code>plot_dvtime</code><a class="anchor" aria-label="anchor" href="#overview-of-plot_dvtime"></a>
</h3>
<p>Let’s visualize the data. First, we will filter to observation
records only and derive some factor variables, which can be passed to
the color aesthetic in our plots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">data_sad</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`Dose (mg)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">DOSE</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">400</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         `Food Status` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">FOOD</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fasted"</span>, <span class="st">"Fed"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s visualize the concentration-time data.
<code>pmxhelpr</code> includes a function for common visualizations of
observed concentration-time data in exploratory data analysis:
<code>plot_dvtime</code></p>
<p>In our visualizations, we will leverage the following dataset
variables:</p>
<ul>
<li>
<code>ODV</code>: the original dependent variable (drug
concentration) in untransformed units (ng/mL)</li>
<li>
<code>TIME</code> : actual time since first dose (hours)</li>
<li>
<code>NTIME</code>: nominal time since first dose (hours)</li>
<li>
<code>LLOQ</code> : lower limit of quantification for drug
concentration</li>
</ul>
<p><code>plot_dvtime</code> requires a dependent variable, specified as
string via the <code>dv_var</code> argument, and time variables for
actual and nominal time, specified as a named vector using the
<code>time_vars</code>. The default names for the <code>time_vars</code>
are <code>"TIME"</code> and <code>"NTIME"</code>. The color aesthetic is
specified using the <code>col_var</code> argument. The <code>cent</code>
argument specifies which central tendency measure is plotted.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-1.png" width="576"></p>
<p>Not a bad plot with minimal arguments! We can see the mean for each
dose as a colored thick line and observed data points as colored open
circles with some alpha added. A caption also prints by default
describing the plot elements.</p>
<p>The caption can be removed by specifying
<code>show_caption = FALSE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, show_caption <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-nocap-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="adjusting-time-breaks">Adjusting Time Breaks<a class="anchor" aria-label="anchor" href="#adjusting-time-breaks"></a>
</h3>
<p><code>plot_dvtime</code> includes uses a helper function
(<code>breaks_time</code>) to automatically determine x-axis breaks
based on the units of the time variable! Two arguments in
<code>plot_dvtime</code> are passed to <code>breaks_time</code>:</p>
<ul>
<li>
<p><code>timeu</code> character string specifying time units.
Options include:</p>
<ul>
<li>“hours” (default), “hrs”, “hr”, “h”</li>
<li>“days”, “dys”, “dy”, “d”</li>
<li>“weeks”, “wks”, “wk”, “w”</li>
<li>“months”, “mons”, “mos”, “mo”, “m”</li>
</ul>
</li>
<li><p><code>n_breaks</code> number breaks requested from the algorithm.
Default = 8.</p></li>
</ul>
<p>Let’s pass the vector of nominal times we defined earlier into the
<code>breaks_time</code> function and see what we get with different
requested numbers of breaks!</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/breaks_time.html">breaks_time</a></span><span class="op">(</span><span class="va">ntimes</span>, unit <span class="op">=</span> <span class="st">"hours"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   0  24  48  72  96 120 144 168</span></span>
<span><span class="fu"><a href="../reference/breaks_time.html">breaks_time</a></span><span class="op">(</span><span class="va">ntimes</span>, unit <span class="op">=</span> <span class="st">"hours"</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]   0  48  96 144</span></span>
<span><span class="fu"><a href="../reference/breaks_time.html">breaks_time</a></span><span class="op">(</span><span class="va">ntimes</span>, unit <span class="op">=</span> <span class="st">"hours"</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ntimes</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]   0.0   9.6  19.2  28.8  38.4  48.0  57.6  67.2  76.8  86.4  96.0 105.6</span></span>
<span><span class="co">#&gt; [13] 115.2 124.8 134.4 144.0 153.6 163.2</span></span></code></pre></div>
<p>We can see that the default (n = 8) gives an optimal number of breaks
in this case whereas reducing the number of breaks (n=5) gives a less
optimal distribution of values. Requesting breaks equal to the length of
the vector of unique <code>NTIMES</code> will generally produce too many
breaks. The default axes breaks behavior can always be overwritten by
specifying the axis breaks manually using
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous()</a></code>.</p>
<p>The default <code>n_breaks = 8</code> is a good value for
<code>data_sad</code>, and <code>data_sad</code> uses the default time
units (<code>"hours"</code>); therefore, explicit specification of the
<code>n_breaks</code> and <code>timeu</code> arguments is not
required.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-breaks-1.png" width="576"></p>
<p>However, perhaps someone on the team would prefer the x-axis breaks
in units of <code>days</code>. The x-axis breaks will transform to the
new units automatically as long as we specify the new time unit with
<code>timeu = "days"</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_days</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="va">TIME</span><span class="op">/</span><span class="fl">24</span>, </span>
<span>         NTIME <span class="op">=</span> <span class="va">NTIME</span><span class="op">/</span><span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data_days</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, timeu <span class="op">=</span> <span class="st">"days"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-breaks-days-1.png" width="576"></p>
<p>Nice! However, someone else on the team would prefer to see the first
24 hours of treatment in greater detail to visualize the absorption
phase. We can either truncate the x-axis range using
<code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous()</a></code>, or filter the input data and allow
the x-axis breaks to adjust automatically with the new time range in the
input data!</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_24</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">NTIME</span> <span class="op">&lt;=</span> <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data_24</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-breaks-24h-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="specifying-the-central-tendency">Specifying the Central Tendency<a class="anchor" aria-label="anchor" href="#specifying-the-central-tendency"></a>
</h3>
<p>These data are probably best visualized on a log-scale y-axis
upweight the terminal phase profile. <code>plot_dvtime</code> includes
an argument <code>log_y</code> which performs this operation with some
additional formatting benefits over manually adding the layer to the
returned object with <code>scale_y_log10</code>.</p>
<ul>
<li>Includes log tick marks on the y-axis</li>
<li>Updates the caption with the correct central tendency measure if
<code>show_captions = TRUE</code>.</li>
</ul>
<p><code>plot_dvtime</code> uses the <code>stat_summary</code> function
from <code>ggplot2</code> to calculate and plot the central tendency
measures and error bars. An often overlooked feature of
<code>stat_summary</code>, is that it calculates the summary statistics
<em>after</em> any transformations to the data performed by changing the
scales. This means that when <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10()</a></code> is applied to
the plot, the data are log-transformed for plotting and the central
tendency measure returned when requesting <code>"mean"</code> from
<code>stat_summary</code> is the <em>geometric mean</em>. If the
<code>log_y</code> argument is used to generate semi-log plots along
with <code>show_captions = TRUE</code>, then the caption will delineate
where arithmetic and gemoetric means are being returned.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-part-log-1.png" width="576"></p>
<p>But wait…this plot is potentially misleading! The food effect portion
of the study is being pooled together with the fasted data within the
100 mg dose.</p>
<p>Luckily, <code>plot_dvtime</code> returns a <code>ggplot</code>
object which we can modify like any other <code>ggplot</code>!
Therefore, we can facet by PART by simply adding in another layer to our
<code>ggplot</code> object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-part-1.png" width="576"></p>
<p>The clinical team would like a simpler plot that clearly displays the
central tendency. We can use the argument <code>cent = "mean_sdl"</code>
to plot the mean with error bars and remove the observed points by
specifying <code>obs_dv = FALSE</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            obs_dv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime_part-meansdl-1.png" width="576"></p>
<p>We may want to only show the upper error bar, especially when
computing the arithmetic mean +/- arithmetic SD on the linear scale.
This can be accomplished by changing the <code>cent</code> argument to
<code>mean_sdl_upper</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean_sdl_upper"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, obs_dv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime_part-meansdl-upper-1.png" width="576"></p>
<p>We could also plot these data as median + interquartile range (IQR)
using, if we do not feel the sample size is sufficient for parametric
summary statistics. This can be accomplished by changing the
<code>cent</code> argument to <code>median_iqr</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"median_iqr"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            obs_dv <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime_part-medianiqr-1.png" width="576"></p>
<p>Hmm…there is some noise at the late terminal phase. This is likely
artifact introduced by censoring of data at the assay LLOQ; however,
let’s confirm there are no weird individual subject profiles by
connecting observed data points longitudinally within a subject - in
other words, let’s make spaghetti plots!</p>
<p>We will change the central tendency measure to the median and add the
spaghetti lines. Data points within an individual value of
<code>grp_var</code> will be connected by a narrow line when
<code>grp_dv = TRUE</code>. The default is
<code>grp_var = "ID"</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"median"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            grp_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-part-ind-1.png" width="576"></p>
<p>It does not seem like there are outlier individuals driving the noise
in the late terminal phase; therefore, this is almost certainly artifact
introduced by data missing due to assay sensitivity and censoring at the
lower limit of quantification (LLOQ).</p>
</div>
<div class="section level3">
<h3 id="defining-imputations-for-blq-data">Defining imputations for BLQ data<a class="anchor" aria-label="anchor" href="#defining-imputations-for-blq-data"></a>
</h3>
<p>Let’s use imputation to assess the potential impact of the data
missing due to assay sensitivity. <code>plot_dvtime</code> includes some
functionality to do this imputation for us using the <code>loq</code>
and <code>loq_method</code> arguments.</p>
<p>The <code>loq_method</code> argument species how BLQ imputation
should be performed. Options are:</p>
<ul>
<li>
<code>0</code> : No handling. Plot input dataset <code>DV</code> vs
<code>TIME</code> as is. (default)</li>
<li>
<code>1</code> : Impute all BLQ data at <code>TIME</code> &lt;= 0 to
0 and all BLQ data at <code>TIME</code> &gt; 0 to 1/2 x
<code>loq</code>. Useful for plotting concentration-time data with some
data BLQ on the linear scale</li>
<li>
<code>2</code> : Impute all BLQ data at <code>TIME</code> &lt;= 0 to
1/2 x <code>loq</code> and all BLQ data at <code>TIME</code> &gt; 0 to
1/2 x <code>loq</code>.</li>
</ul>
<p>The <code>loq</code> argument species the value of the LLOQ. The
<code>loq</code> argument must be specified when <code>loq_method</code>
is <code>1</code> or <code>2</code>, but can be <code>NULL</code>
<em>if</em> the variable <code>LLOQ</code> is present in the dataset. In
our case, <code>LLOQ</code> is a variable in <code>plot_data</code>, so
we do not need to specify the <code>loq</code> argument (default is
<code>loq = NULL</code>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq1-1.png" width="576"></p>
<p>The same plot is obtained by specifying <code>loq = 1</code></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>,  log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span>, loq <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-1.png" width="576"></p>
<p>A reference line is drawn to denote the LLOQ and all observations
with <code>EVID=0</code> and <code>MDV=1</code> are imputed as LLOQ/2.
Imputing post-dose concentrations below the lower limit of
quantification as 1/2 x LLOQ normalizes the late terminal phase of the
concentration-time profile. This is confirmatory evidence for our
hypothesis that the noise in the late terminal phase is due to censoring
of observations below the LLOQ.</p>
</div>
<div class="section level3">
<h3 id="dose-normalization">Dose-normalization<a class="anchor" aria-label="anchor" href="#dose-normalization"></a>
</h3>
<p>We can also generate dose-normalized concentration-time plots by
specifying <code>dosenorm = TRUE</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Dose-normalized Conc. (ng/mL per mg Drug)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            dosenorm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-dn-1.png" width="576"></p>
<p>When <code>dosenorm = TRUE</code>, the variable specified in
<code>dose_var</code> (default = “DOSE”) needs to be present in the
input dataset <code>data</code>. If <code>dose_var</code> is not present
in <code>data</code>, the function will return an <em>Error</em> with an
informative error message.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="op">-</span><span class="va">DOSE</span><span class="op">)</span>, </span>
<span>            dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Dose-normalized Conc. (ng/mL per mg Drug)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            dosenorm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `check_varsindf()`:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> argument `dose_var` must be variables in `data`</span></span></code></pre></div>
<p>Dose-normalization is performed <em>AFTER</em> BLQ imputation in the
case in which both options are requested. The reference line for the
LLOQ will not be plotted when dose-normalized concentration is the
dependent variable.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Dose-normalized Conc. (ng/mL per mg Drug)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span>, dosenorm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq-dn-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="adjusting-the-color-and-group-aesthetics">Adjusting the Color and Group Aesthetics<a class="anchor" aria-label="anchor" href="#adjusting-the-color-and-group-aesthetics"></a>
</h3>
<p>Only a single variable can be passed to the <code>col_var</code>
argument of <code>plot_dvtime</code>. Suppose we want to look at the
interaction between two variables in the color aesthetic. This can be
accomplished using the <code>interaction</code> function within the
<code>aes</code> call, which computes an unordered factor representing
the interaction between the two variables. Let’s visualize the
interaction between the factor versions of the variables
<code>DOSE</code> and <code>FOOD</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">ODV</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">`Dose (mg)`</span>, <span class="va">`Food Status`</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NTIME</span>, y <span class="op">=</span> <span class="va">ODV</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">`Dose (mg)`</span>, <span class="va">`Food Status`</span><span class="op">)</span><span class="op">)</span>,</span>
<span>               fun.y <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">168</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, x <span class="op">=</span> <span class="st">"Time (hours)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-int-1.png" width="576"></p>
<p>The functionality of <code><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction()</a></code> cannot be used within
<code>plot_dvtime</code>; however, we can reproduce it by formally
creating a variable for the interaction we want to visualize. This also
affords us the opportunity to define the factor labels, levels, and
order, which will affect how the interaction is displayed on the
plot.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_int</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`Dose (mg) and Food` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">FOOD</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">"mg"</span>, <span class="st">"Fasted"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">"mg"</span>, <span class="st">"Fed"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         `Dose (mg) and Food` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">`Dose (mg) and Food`</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"50 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"100 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"100 mg Fed"</span>, </span>
<span>                                                                         <span class="st">"200 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"400 mg Fasted"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data_int</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg) and Food"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-int-1.png" width="576"></p>
<p>This looks pretty nice! The legend is formatted cleanly and the
colors are assigned to each unique condition of the interaction.
However, we can actually take this one step further, and define our
interaction variable as an <em>ordered</em> factor, which results
<code>ggplot2</code> applying the <em>viridis</em> color scale from the
<code>viridisLite</code> package.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_int_ordered</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`Dose (mg) and Food` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">FOOD</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">"mg"</span>, <span class="st">"Fasted"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">"mg"</span>, <span class="st">"Fed"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         `Dose (mg) and Food` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">`Dose (mg) and Food`</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"50 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"100 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"100 mg Fed"</span>, </span>
<span>                                                                         <span class="st">"200 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"400 mg Fasted"</span><span class="op">)</span>,</span>
<span>                                       ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data_int_ordered</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg) and Food"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-int-order-1.png" width="576"></p>
<p>The same approach can be used to define an interaction variable to be
assigned to the group aesthetic using the <code>grp_var</code> argument
to <code>plot_dvtime</code>. Such an approach may be used if we wanted
to visualize the data for a cross-over study condition separately for
each period within an individual. In this case, the default
<code>grp_var = "ID"</code> would connect all data points within an
individual across both periods whereas we actually want to visualize
points connected within the individual <code>"ID"</code> separately by
cross-over period.</p>
<p>To explore this, we will modify <code>data_sad</code> such that the
same subjects are included in <code>"PART1-SAD"</code> and
<code>"PART2-FE</code> (e.g., modify from a parallel group design to a
crossover design).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_crossover</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">FOOD</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">ID</span> <span class="op">-</span> <span class="fl">6</span>, <span class="va">ID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_data_crossover</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">DOSE</span>, <span class="va">FOOD</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ID</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">FOOD</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">FOOD</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   ID [6]</span></span></span>
<span><span class="co">#&gt;       ID  DOSE  FOOD</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    13   100     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    13   100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    14   100     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    14   100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    15   100     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    15   100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    16   100     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    16   100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    17   100     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    17   100     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    18   100     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    18   100     1</span></span></code></pre></div>
<p>Now we have a dataset with a cross-over design for the Food Effect
protion of the study. We can define a factor variable that is the
interaction between <code>"ID"</code> and <code>"FOOD"</code>. Now when
we visualize the data, the data points will be connected within the
group defined by both variables.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data_crossover_fid</span> <span class="op">&lt;-</span> <span class="va">plot_data_crossover</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>FID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">FOOD</span><span class="op">)</span>,</span>
<span>         `Dose (mg) and Food` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">FOOD</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">"mg"</span>, <span class="st">"Fasted"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">DOSE</span>, <span class="st">"mg"</span>, <span class="st">"Fed"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>         `Dose (mg) and Food` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">`Dose (mg) and Food`</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"50 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"100 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"100 mg Fed"</span>, </span>
<span>                                                                         <span class="st">"200 mg Fasted"</span>, </span>
<span>                                                                         <span class="st">"400 mg Fasted"</span><span class="op">)</span>,</span>
<span>                                       ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data_crossover_fid</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg) and Food"</span>, cent <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>            grp_var <span class="op">=</span> <span class="st">"FID"</span>, grp_dv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-crossover-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="adjusting-the-attributes-for-points-and-lines">Adjusting the Attributes for Points and Lines<a class="anchor" aria-label="anchor" href="#adjusting-the-attributes-for-points-and-lines"></a>
</h3>
<p>The default attributes of data points and lines are controlled by the
<code>theme</code> argument. The defaults</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime_theme.html">plot_dvtime_theme</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $linewidth_ref</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linetype_ref</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_line_ref</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $shape_point_obs</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $size_point_obs</span></span>
<span><span class="co">#&gt; [1] 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_point_obs</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linewidth_obs</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linetype_obs</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_line_obs</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $shape_point_cent</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $size_point_cent</span></span>
<span><span class="co">#&gt; [1] 1.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_point_cent</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linewidth_cent</span></span>
<span><span class="co">#&gt; [1] 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linetype_cent</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_line_cent</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linewidth_errorbar</span></span>
<span><span class="co">#&gt; [1] 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $linetype_errorbar</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $alpha_errorbar</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $width_errorbar</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>These attributes can be updated by passing a named list to the
<code>theme</code> argument. Say we want to reduce the linewidth of the
error bars and reduce the size of the mean summary points to only
visualize the lines. This can be accomplished for an individual plot as
follows:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            obs_dv <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            theme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth_errorbar <span class="op">=</span> <span class="fl">0.5</span>, size_point_cent <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-part-meansdl-theme-1.png" width="576"></p>
<p>One could also globally set a new theme by updating the default using
<code>plot_dvtime_theme</code> and pass the new theme list object to the
<code>theme</code> argument. This is useful if generating multiple plots
using the same modified theme.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_theme</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_dvtime_theme.html">plot_dvtime_theme</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linewidth_errorbar <span class="op">=</span> <span class="fl">0.5</span>, size_point_cent <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            obs_dv <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            theme <span class="op">=</span> <span class="va">new_theme</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-part-meansdl-themeset-1.png" width="576"></p>
<p>The default error bar width is 2.5% of the maximum nominal time in
the dataset. This can be overwritten to a user-specified value using the
<code>width_errorbar</code> attribute of <code>plot_dvtime_theme</code>.
This value is passed to the <code>width</code> argument of
<code>geom_errorbar</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"mean_sdl"</span>, </span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            obs_dv <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>            theme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width_errorbar <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-part-meansdl-width-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="individual-concentration-time-plots">Individual Concentration-time plots<a class="anchor" aria-label="anchor" href="#individual-concentration-time-plots"></a>
</h2>
<p>The previous section provides an overview of how to generate
population concentration-time profiles by dose using
<code>plot_dvtime</code>; however, we can also use
<code>plot_dvtime</code> to generate subject-level visualizations with a
little pre-processing of the input dataset.</p>
<p>We can specify <code>cent = "none"</code> to remove the central
tendency layer when plotting individual subject data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="va">plot_data</span>, dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            grp_dv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span>, loq <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indonly-1.png" width="576"></p>
<p>We can plot an individual subject by filtering the input dataset.
This could be extended generate plots for all individuals using
<code>for</code> loops, <code>lapply</code>, <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code>
functions, or other methods.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="co">#vector of unique subject ids</span></span>
<span><span class="va">n_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span> <span class="co">#count of unique subject ids</span></span>
<span><span class="va">plots_per_pg</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">n_pgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">n_ids</span><span class="op">/</span><span class="va">plots_per_pg</span><span class="op">)</span> <span class="co">#Total number of pages needed</span></span>
<span></span>
<span><span class="va">plist</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_ids</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">plist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_dvtime.html">plot_dvtime</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">ID</span> <span class="op">==</span> <span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                               dv_var <span class="op">=</span> <span class="st">"ODV"</span>, col_var <span class="op">=</span> <span class="st">"Dose (mg)"</span>, cent <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>            ylab <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, log_y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            grp_dv <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            loq_method <span class="op">=</span> <span class="fl">2</span>, loq <span class="op">=</span> <span class="fl">1</span>, show_caption <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ID = "</span>, <span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">" | Dose = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">DOSE</span><span class="op">[</span><span class="va">plot_data</span><span class="op">$</span><span class="va">ID</span><span class="op">==</span><span class="va">ids</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="st">" mg"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_pgs</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n_pg</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">i</span> <span class="op">&lt;-</span>  <span class="op">(</span><span class="va">n_pg</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">plots_per_pg</span><span class="op">+</span><span class="fl">1</span></span>
<span>      <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">n_pg</span><span class="op">*</span><span class="va">plots_per_pg</span></span>
<span>      <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">plist</span><span class="op">[</span><span class="va">i</span><span class="op">:</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-2.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-3.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-4.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-5.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-6.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-7.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-8.png" width="576"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span></code></pre>
<p><img src="eda-pmxhelpr_files/figure-html/plot-dvtime-blq2-indplots-9.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="dose-proportionality-assessment-power-law-regression">Dose-proportionality Assessment: Power Law Regression<a class="anchor" aria-label="anchor" href="#dose-proportionality-assessment-power-law-regression"></a>
</h2>
<p>Another assessment that is commonly performed for pharmacokinetic
data is dose proportionality (e.g., does exposure increase
proportionally with dose). This is an important assessment prior to
population PK modeling, as it informs whether non-linearity is an
important consideration in model development.</p>
<p>The industry standard approach to assessing dose proportionality is
power law regression. Power law regression is based on the following
relationship:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>u</mi><mi>r</mi><mi>e</mi><mo>=</mo><mi>α</mi><mo>*</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>O</mi><mi>S</mi><mi>E</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>γ</mi></msup></mrow><annotation encoding="application/x-tex">Exposure = \alpha*(DOSE)^\gamma</annotation></semantics></math></p>
<p>This power relationship can be transformed to a linear relationship
to support quantitative estimation of the power
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>)
via simple linear regression by taking the logarithm of both sides:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>u</mi><mi>r</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>i</mi><mi>n</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mo>+</mo><mi>γ</mi><mo>*</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mi>O</mi><mi>S</mi><mi>E</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">log(Exposure) = intercept + \gamma*log(DOSE)</annotation></semantics></math></p>
<p><code>NOTE</code>: Use of natural logarithm and log10 transformations
will not impact the assessment of the power and will only shift the
intercept.</p>
<p>This approach facilitates hypothesis testing via assessment of the
95% CI around the power
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>)
estimated from the log-log regression. The null hypothesis is that
exposure increases proportionally to dose (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma=1</annotation></semantics></math>)
and the alternative hypothesis is that exposure does <em>NOT</em>
increase proportionally to dose (e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>≠</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma\ne 1</annotation></semantics></math>).</p>
<p>Interpretation of the relationship is based on the 95% CI of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
estimate as follows:</p>
<ul>
<li>95% CI includes one (1): exposure increases proportionally to
dose</li>
<li>95% CI excludes one (1) &amp; is less than 1: exposure increases
less-than-proportionally to dose</li>
<li>95% CI excludes one (1) &amp; is greater than 1: exposure increases
greater-than-proportionally to dose</li>
</ul>
<p>This assessment is generally performed based on both maximum
concentration (Cmax) and area under the concentration-time curve (AUC).
While not a hard and fast rule, some inference can be drawn about which
phase of the pharmacokinetic profile is most likely contributing the
majority of the non-linearity of exposure with dose.</p>
<ul>
<li>AUC = <em>NOT</em> dose-proportional | Cmax = dose-proportional =
elimination phase</li>
<li>AUC = dose-proportional | Cmax = <em>NOT</em> dose-proportional =
absorption phase (rate)</li>
<li>AUC = <em>NOT</em> dose-proportional | Cmax = <em>NOT</em>
dose-proportional = absorption phase (extent)</li>
</ul>
<p>These exploratory assessments provide quantitative support for
structural PK model decision-making. Practically speaking,
non-linearities in absorption rate are rarely impactful, and the modeler
is really deciding between dose-dependent bioavailability and
concentration-dependent elimination (e.g., Michaelis-Menten kinetics,
target-mediated drug disposition [TMDD])</p>
<div class="section level3">
<h3 id="step-1-derive-nca-parameters">Step 1: Derive NCA Parameters<a class="anchor" aria-label="anchor" href="#step-1-derive-nca-parameters"></a>
</h3>
<p>The first step in performing this assessment is deriving the
necessary NCA PK parameters. NCA software (e.g., Phoenix WinNonlin) is
quite expensive; however, thankfully there is an excellent R package for
performing NCA analyses - <code>PKNCA</code>.</p>
<p>Refer to the documentation for the <code>PKNCA</code> packge for
details. This vignette will not provide a detailed overview of
<code>PKNCA</code> functions and workflows.</p>
<p>First, let’s set the options for our NCA analysis and define the
intervals over which we want to obtain the NCA parameters. The
<code>data_sad</code> dataset internal to <code>pmxhelpr</code> is a
single ascending dose (SAD) design with a parallel food effect (FE)
cohort; therefore, our interval is [0,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>∞</mi><annotation encoding="application/x-tex">\infty</annotation></semantics></math>]</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Set NCA options</span></span>
<span><span class="fu"><a href="http://humanpred.github.io/pknca/reference/PKNCA.options.html" class="external-link">PKNCA.options</a></span><span class="op">(</span>conc.blq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"first"</span> <span class="op">=</span> <span class="st">"keep"</span>, </span>
<span>                              <span class="st">"middle"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">LLOQ</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">LLOQ</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                              <span class="st">"last"</span> <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span>,</span>
<span>              allow.tmax.in.half.life <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              min.hl.r.squared <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##Calculation Intervals and Requested Parameters</span></span>
<span><span class="va">intervals</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fl">0</span>,</span>
<span>             end <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>             auclast <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             aucinf.obs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             aucpext.obs <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             half.life <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             cmax <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             vz.obs <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             cl.obs <span class="op">=</span> <span class="cn">TRUE</span> </span>
<span>             <span class="op">)</span>  </span></code></pre></div>
<p>Next, we will set up our dose and concentration objects and perform
the NCA using <code>PKNCA</code></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Impute BLQ concentrations to 0 (PKNCA formatting)</span></span>
<span><span class="va">data_sad_nca_input</span> <span class="op">&lt;-</span> <span class="va">data_sad</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>CONC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ODV</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">ODV</span><span class="op">)</span>, </span>
<span>         AMT <span class="op">=</span> <span class="va">AMT</span><span class="op">/</span><span class="fl">1000</span><span class="op">)</span> <span class="co">#Convert from mg to ug (concentration is ng/mL = ug/L)</span></span>
<span></span>
<span><span class="co">#Build PKNCA objects for concentration and dose including relevant strata</span></span>
<span><span class="va">conc_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://humanpred.github.io/pknca/reference/PKNCAconc.html" class="external-link">PKNCAconc</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_sad_nca_input</span>, <span class="va">EVID</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span>, <span class="va">CONC</span><span class="op">~</span><span class="va">TIME</span><span class="op">|</span><span class="va">ID</span><span class="op">+</span><span class="va">DOSE</span><span class="op">+</span><span class="va">PART</span><span class="op">)</span></span>
<span><span class="va">dose_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://humanpred.github.io/pknca/reference/PKNCAdose.html" class="external-link">PKNCAdose</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_sad_nca_input</span>, <span class="va">EVID</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span>, <span class="va">AMT</span><span class="op">~</span><span class="va">TIME</span><span class="op">|</span><span class="va">ID</span><span class="op">+</span><span class="va">PART</span><span class="op">)</span></span>
<span><span class="va">nca_data_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://humanpred.github.io/pknca/reference/PKNCAdata.html" class="external-link">PKNCAdata</a></span><span class="op">(</span><span class="va">conc_obj</span>, <span class="va">dose_obj</span>, intervals <span class="op">=</span> <span class="va">intervals</span><span class="op">)</span></span>
<span><span class="va">nca_results_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="http://humanpred.github.io/pknca/reference/pk.nca.html" class="external-link">pk.nca</a></span><span class="op">(</span><span class="va">nca_data_obj</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">nca_results_obj</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 648</span></span>
<span><span class="co">#&gt; Columns: 8</span></span>
<span><span class="co">#&gt; $ ID       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2…</span></span>
<span><span class="co">#&gt; $ DOSE     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ PART     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part…</span></span>
<span><span class="co">#&gt; $ start    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0…</span></span>
<span><span class="co">#&gt; $ end      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>I…</span></span>
<span><span class="co">#&gt; $ PPTESTCD <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "auclast"<span style="color: #949494;">, </span>"cmax"<span style="color: #949494;">, </span>"tmax"<span style="color: #949494;">, </span>"tlast"<span style="color: #949494;">, </span>"clast.obs"<span style="color: #949494;">, </span>"lambda.z"<span style="color: #949494;">, </span>…</span></span>
<span><span class="co">#&gt; $ PPORRES  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 277.7701457207<span style="color: #949494;">, </span>13.4300000000<span style="color: #949494;">, </span>7.8100000000<span style="color: #949494;">, </span>35.9500000000<span style="color: #949494;">, </span>3…</span></span>
<span><span class="co">#&gt; $ exclude  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">N</span>…</span></span></code></pre></div>
<p>The NCA results object output from <code>PKNCA</code> is formatted
using the variable names in <code>SDTM</code> standards for the
<code>PP</code> domain (Pharmacokinetic Parameters). This NCA output
dataset is also available internally within <code>pmxhelpr</code> as
<code>data_sad_nca</code> with a few additional columns specifying
units.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">data_sad_nca</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 612</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ ID         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ DOSE       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">, </span>10<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ PART       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Part 1-SAD"<span style="color: #949494;">, </span>"Pa…</span></span>
<span><span class="co">#&gt; $ start      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">, </span>0<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ end        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">, </span>Inf<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ PPTESTCD   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "auclast"<span style="color: #949494;">, </span>"cmax"<span style="color: #949494;">, </span>"tmax"<span style="color: #949494;">, </span>"tlast"<span style="color: #949494;">, </span>"clast.obs"<span style="color: #949494;">, </span>"lambda.z"…</span></span>
<span><span class="co">#&gt; $ PPORRES    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 277.7701457207<span style="color: #949494;">, </span>13.4300000000<span style="color: #949494;">, </span>7.8100000000<span style="color: #949494;">, </span>35.9500000000<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ exclude    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">, </span><span style="color: #BB0000;">NA</span><span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ units_dose <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">, </span>"mg"<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">#&gt; $ units_conc <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ng/mL"<span style="color: #949494;">, </span>"ng/mL"<span style="color: #949494;">, </span>"ng/mL"<span style="color: #949494;">, </span>"ng/mL"<span style="color: #949494;">, </span>"ng/mL"<span style="color: #949494;">, </span>"ng/mL"<span style="color: #949494;">, </span>"ng/m…</span></span>
<span><span class="co">#&gt; $ units_time <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "hours"<span style="color: #949494;">, </span>"hours"<span style="color: #949494;">, </span>"hours"<span style="color: #949494;">, </span>"hours"<span style="color: #949494;">, </span>"hours"<span style="color: #949494;">, </span>"hours"<span style="color: #949494;">, </span>"hour…</span></span></code></pre></div>
<p>We will need to select the relevant PK parameters from this dataset
for input into our power law regression analysis of
dose-proportionality. Thankfully, <code>pmxhelpr</code> handles the
filtering and power law regression in one step with functions for
outputting either tables or plots of results!</p>
</div>
<div class="section level3">
<h3 id="step-2-perform-power-law-regression">Step 2: Perform Power Law Regression<a class="anchor" aria-label="anchor" href="#step-2-perform-power-law-regression"></a>
</h3>
<p>The <code>df_doseprop</code> function is a wrapper function which
bundles two other <code>pmxhelpr</code> functions:</p>
<ul>
<li>
<code>mod_loglog</code> a function to perform log-log regression
which returns a <code>lm</code> object</li>
<li>
<code>df_loglog</code> a function to tabulate the power estimate and
CI which returns a <code>data.frame</code>
</li>
</ul>
<p>There are two required arguments to <code>df_doseprop</code>.</p>
<ul>
<li>
<code>data</code> a <code>data.frame</code> containing NCA parameter
estimates</li>
<li>
<code>metrics</code> a character vector of NCA parameters to
evaluate in log-log regression</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df_doseprop.html">df_doseprop</a></span><span class="op">(</span><span class="va">data_sad_nca</span>, metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aucinf.obs"</span>, <span class="st">"cmax"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">power_table</span></span>
<span><span class="co">#&gt;   Intercept StandardError  CI Power   LCL  UCL Proportional</span></span>
<span><span class="co">#&gt; 1      4.04        0.0663 95% 0.997 0.867 1.13         TRUE</span></span>
<span><span class="co">#&gt; 2      1.09        0.0616 95% 1.070 0.947 1.19         TRUE</span></span>
<span><span class="co">#&gt;                            PowerCI    Interpretation   PPTESTCD</span></span>
<span><span class="co">#&gt; 1 Power: 0.997 (95% CI 0.867-1.13) Dose-proportional aucinf.obs</span></span>
<span><span class="co">#&gt; 2  Power: 1.07 (95% CI 0.947-1.19) Dose-proportional       cmax</span></span></code></pre></div>
<p>The table includes the relevant estimates from the power law
regression (intercept, standard error, power, lower confidence limit,
upper confidence limit), as well as, a logical flag for
dose-proportionality and text interpretation.</p>
<p>Based on this assessment, these data appear dose-proportional for
both Cmax and AUC! However, we should not include the food effect part
of the study in this assessment, as food could also influence these
parameters, and confounds the assessment of dose proportionality. The
most important thing is to understand the input data!</p>
<p>Let’s run it again, but this time only include
<code>Part 1-SAD</code>.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">power_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df_doseprop.html">df_doseprop</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_sad_nca</span>, <span class="va">PART</span> <span class="op">==</span> <span class="st">"Part 1-SAD"</span><span class="op">)</span>, metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aucinf.obs"</span>, <span class="st">"cmax"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">power_table</span></span>
<span><span class="co">#&gt;   Intercept StandardError  CI Power   LCL  UCL Proportional</span></span>
<span><span class="co">#&gt; 1      3.97        0.0438 95% 0.979 0.893 1.07         TRUE</span></span>
<span><span class="co">#&gt; 2      1.06        0.0616 95% 1.060 0.939 1.18         TRUE</span></span>
<span><span class="co">#&gt;                            PowerCI    Interpretation   PPTESTCD</span></span>
<span><span class="co">#&gt; 1 Power: 0.979 (95% CI 0.893-1.07) Dose-proportional aucinf.obs</span></span>
<span><span class="co">#&gt; 2  Power: 1.06 (95% CI 0.939-1.18) Dose-proportional       cmax</span></span></code></pre></div>
<p>In this case, the interpretation is unchanged with and without
inclusion of the food effect cohort. <code>df_doseprop</code> provides
two arguments for defining the confidence interval.</p>
<ul>
<li>
<code>method</code>: method to derive the upper and lower confidence
limits. The default is <code>"normal"</code>, specifying use of the
normal distribution, with <code>"tdist"</code> as an alternative,
specifying use of the t-distribution. The t-distribution is preferred
for analyses with smaller sample sizes</li>
<li>
<code>ci</code>: width of the confidence interval. The default is
<code>0.95</code> (95% CI) with <code>0.90</code> (90% CI) as an
alternative</li>
</ul>
</div>
<div class="section level3">
<h3 id="step-3-visualize-the-power-law-regression">Step 3: Visualize the Power Law Regression<a class="anchor" aria-label="anchor" href="#step-3-visualize-the-power-law-regression"></a>
</h3>
<p>We can also visualize these data using the <code>plot_doseprop</code>
function. This function leverages the linear regression option within
<code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">ggplot2::geom_smooth()</a></code> to perform the log-log regression
for visualization and pulls in the functionality of
<code>df_doseprop</code> to extract the power estimate and CI into the
facet label.</p>
<p>The required arguments to <code>plot_doseprop</code> are the same as
<code>df_doseprop</code>!</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_doseprop.html">plot_doseprop</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">data_sad_nca</span>, <span class="va">PART</span> <span class="op">==</span> <span class="st">"Part 1-SAD"</span><span class="op">)</span>, metrics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aucinf.obs"</span>, <span class="st">"cmax"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="eda-pmxhelpr_files/figure-html/power-law-plot-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Crass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
