<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>vpc-exact-bins • pmxhelpr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="vpc-exact-bins">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pmxhelpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vpc-exact-bins.html">vpc-exact-bins</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ryancrass/pmxhelpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>vpc-exact-bins</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ryancrass/pmxhelpr/blob/main/vignettes/vpc-exact-bins.Rmd" class="external-link"><code>vignettes/vpc-exact-bins.Rmd</code></a></small>
      <div class="d-none name"><code>vpc-exact-bins.Rmd</code></div>
    </div>

    
    
<p>This vignette will review the limitations of the <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code>
function for datasets containing exact bins as the motivating example
for development <code><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins()</a></code>. First we will load
the required packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ryancrass/pmxhelpr" class="external-link">pmxhelpr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ronkeizer/vpc" class="external-link">vpc</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/metrumresearchgroup/mrgsolve" class="external-link">mrgsolve</a></span>, warn.conflicts <span class="op">=</span>  <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Next let’s explore our input dataset <code>data_sad</code>. This
dataset was generated via simulation from the mrgsolve
<code>model</code> internal to the pmxhelpr package. We can take a quick
look at the dataset using <code><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse()</a></code> from the dplyr
package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 23</span></span>
<span><span class="co">#&gt; $ LINE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…</span></span>
<span><span class="co">#&gt; $ ID      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,…</span></span>
<span><span class="co">#&gt; $ TIME    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00, 0.00, 0.48, 0.81, 1.49, 2.11, 3.05, 4.14, 5.14, 7.81, 12…</span></span>
<span><span class="co">#&gt; $ NTIME   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0, 0.0, 0.5, 1.0, 1.5, 2.0, 3.0, 4.0, 5.0, 8.0, 12.0, 16.0, …</span></span>
<span><span class="co">#&gt; $ NDAY    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 3, 4, 5, 6, 7, 8, 1,…</span></span>
<span><span class="co">#&gt; $ DOSE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10…</span></span>
<span><span class="co">#&gt; $ AMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, 10, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ EVID    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span></span>
<span><span class="co">#&gt; $ ODV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, 2.02, 4.02, 3.50, 7.18, 9.31, 12.46, 13.43, 12.11,…</span></span>
<span><span class="co">#&gt; $ LDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, 0.7031, 1.3913, 1.2528, 1.9713, 2.2311, 2.5225, 2.…</span></span>
<span><span class="co">#&gt; $ CMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…</span></span>
<span><span class="co">#&gt; $ MDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, NA, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ BLQ     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1, NA, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ LLOQ    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, NA, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ FOOD    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span></span>
<span><span class="co">#&gt; $ SEXF    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…</span></span>
<span><span class="co">#&gt; $ RACE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1,…</span></span>
<span><span class="co">#&gt; $ AGEBL   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25…</span></span>
<span><span class="co">#&gt; $ WTBL    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82…</span></span>
<span><span class="co">#&gt; $ SCRBL   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.…</span></span>
<span><span class="co">#&gt; $ CRCLBL  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 12…</span></span>
<span><span class="co">#&gt; $ USUBJID <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "STUDYNUM-SITENUM-1", "STUDYNUM-SITENUM-1", "STUDYNUM-SITENUM-…</span></span>
<span><span class="co">#&gt; $ PART    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD", "Part 1-SAD", "Part 1-SAD", "Part 1-SAD", "Part …</span></span></code></pre></div>
<p>We can see that this dataset is already formatted for modeling. It
contains NONMEM and mrgsolve reserved variables (e.g., ID, TIME, AMT,
EVID, MDV), as well as, the dependent variable of drug concentration in
original, untransformed units (ODV) and natural logarithm transformed
units (LDV). In addition to the numeric variables there are two
character variables: USUBJID and PART. There are two unique values of
PART indicating two distinct study cohorts: Single Ascending Dose (SAD)
and Food Effect (FE).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">PART</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Part 1-SAD" "Part 2-FE"</span></span></code></pre></div>
<p>This dataset also contains an exact binning variable: Nominal Time
(NTIME). This variable represents the nominal time of sample collection
relative to first dose per study protocol whereas Actual Time (TIME)
represents the actual time the sample was collected.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Unique values of NTIME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">NTIME</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]   0.0   0.5   1.0   1.5   2.0   3.0   4.0   5.0   8.0  12.0  16.0  24.0</span></span>
<span><span class="co">#&gt; [13]  36.0  48.0  72.0  96.0 120.0 144.0 168.0</span></span>
<span></span>
<span><span class="co">##Comparison of number of unique values of NTIME and TIME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">NTIME</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 19</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_sad</span><span class="op">$</span><span class="va">TIME</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 449</span></span></code></pre></div>
<p>Let’s visualize the data. First, we will derive a factor variable
from DOSE to pass to the color aesthetic, as well as, a dependent
variable (DV) with BLQ values imputed to 1/2 x LLOQ.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">data_sad</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EVID</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>`Dose (mg)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">DOSE</span><span class="op">)</span>, </span>
<span>         DV <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">BLQ</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="va">ODV</span>, </span>
<span>                        <span class="va">BLQ</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="va">LLOQ</span><span class="op">/</span><span class="fl">2</span>, </span>
<span>                        .default <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span>, </span>
<span>         DNDV <span class="op">=</span> <span class="va">ODV</span><span class="op">/</span><span class="va">DOSE</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s plot the data using ODV colored by DOSE and faceted by
PART. The concentration-time profiles increase with dose with some
potential impact of censoring at the LLOQ in the late terminal
phase.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">ODV</span>, col <span class="op">=</span> <span class="va">`Dose (mg)`</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">plot_data</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NTIME</span>, y <span class="op">=</span> <span class="va">ODV</span>, col <span class="op">=</span> <span class="va">`Dose (mg)`</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NTIME</span>, y <span class="op">=</span> <span class="va">ODV</span>, col <span class="op">=</span> <span class="va">`Dose (mg)`</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">LLOQ</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">168</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, x <span class="op">=</span> <span class="st">"Time Since Dose Administration (hours)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-conc-time-1.png" width="576"></p>
<p>Imputing post-dose concentrations below the lower limit of
quantification as 1/2 x LLOQ normalizes the late terminal phase of the
concentration-time profile. This suggests that the artifact in the late
terminal phase is due to censoring of observations below the LLOQ, which
impacts lower doses more than higher doses.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TIME</span>, y <span class="op">=</span> <span class="va">DV</span>, col <span class="op">=</span> <span class="va">`Dose (mg)`</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">plot_data</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NTIME</span>, y <span class="op">=</span> <span class="va">DV</span>, col <span class="op">=</span> <span class="va">`Dose (mg)`</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span>, </span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NTIME</span>, y <span class="op">=</span> <span class="va">DV</span>, col <span class="op">=</span> <span class="va">`Dose (mg)`</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">$</span><span class="va">LLOQ</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">168</span>,<span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">PART</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Concentration (ng/mL)"</span>, x <span class="op">=</span> <span class="st">"Time Since Dose Administration (hours)"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-conc-time-blq-1.png" width="576"></p>
<p>Luckily for us, someone has already fit a PK model to these data!
Let’s load the mrgsolve model file internal to the pmxhelpr package by
calling <code><a href="../reference/model_load.html">model_load()</a></code> and take a look at it with
<code><a href="https://rdrr.io/pkg/mrgsolve/man/see.html" class="external-link">mrgsolve::see()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_load.html">model_load</a></span><span class="op">(</span><span class="st">"model"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Building model_cpp ... done.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/mrgsolve/man/see.html" class="external-link">see</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model file:  model.cpp </span></span>
<span><span class="co">#&gt; $PARAM </span></span>
<span><span class="co">#&gt; TVCL = 20</span></span>
<span><span class="co">#&gt; TVVC = 35.7</span></span>
<span><span class="co">#&gt; TVKA = 0.3</span></span>
<span><span class="co">#&gt; TVQ = 25</span></span>
<span><span class="co">#&gt; TVVP = 150</span></span>
<span><span class="co">#&gt; DOSE_F1 = 0.33</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; WT_CL = 0.75</span></span>
<span><span class="co">#&gt; WT_VC = 1.00</span></span>
<span><span class="co">#&gt; WT_Q = 0.75</span></span>
<span><span class="co">#&gt; WT_VP = 1.00</span></span>
<span><span class="co">#&gt; FOOD_KA = -0.5</span></span>
<span><span class="co">#&gt; FOOD_F1 = 1.33</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; WT = 70</span></span>
<span><span class="co">#&gt; DOSE = 100</span></span>
<span><span class="co">#&gt; FOOD = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CMT GUT CENT PERIPH TRANS1 TRANS2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $MAIN</span></span>
<span><span class="co">#&gt; double CL = TVCL*pow(WT/70,WT_CL)*exp(ETA_CL);</span></span>
<span><span class="co">#&gt; double VC  = TVVC*pow(WT/70, WT_VC)*exp(ETA_VC);</span></span>
<span><span class="co">#&gt; double Q = TVCL*pow(WT/70,WT_Q)*exp(ETA_Q);</span></span>
<span><span class="co">#&gt; double VP  = TVVP*pow(WT/70, WT_VP)*exp(ETA_VP);</span></span>
<span><span class="co">#&gt; double KA = TVKA*(1+FOOD_KA*FOOD)*exp(ETA_KA);</span></span>
<span><span class="co">#&gt; double F1 = 1*(1+FOOD_F1*FOOD)*pow(DOSE/100,DOSE_F1);</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; F_GUT = F1;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ODE</span></span>
<span><span class="co">#&gt; dxdt_GUT = -KA*GUT;</span></span>
<span><span class="co">#&gt; dxdt_CENT = KA*TRANS1 - (CL/VC)*CENT + (Q/VP)*PERIPH - (Q/VC)*CENT;</span></span>
<span><span class="co">#&gt; dxdt_PERIPH = (Q/VC)*CENT - (Q/VP)*PERIPH;</span></span>
<span><span class="co">#&gt; dxdt_TRANS1 = KA*GUT - KA*TRANS1;</span></span>
<span><span class="co">#&gt; dxdt_TRANS2 = KA*TRANS1 - KA*TRANS2;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $OMEGA @labels ETA_CL ETA_VC ETA_KA ETA_Q ETA_VP</span></span>
<span><span class="co">#&gt; 0.075 0.1 0.2 0 0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SIGMA @labels PROP</span></span>
<span><span class="co">#&gt; 0.09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $TABLE</span></span>
<span><span class="co">#&gt; capture IPRED = CENT/(VC/1000);</span></span>
<span><span class="co">#&gt; capture DV = IPRED*(1+PROP);</span></span></code></pre></div>
<p>Unluckily for us, no one has validated this PK model! Therefore, we
need to generate some Visual Predictive Checks (VPCs) to validate the
model. We will use <code><a href="../reference/mrgsim_vpc.html">mrgsim_vpc()</a></code> to run the simulation for
the VPC. This is a wrapper function for <code><a href="https://rdrr.io/pkg/mrgsolve/man/mrgsim.html" class="external-link">mrgsim_df()</a></code>, which
uses <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> to iterate the simulation over integers from
1 to replicates.</p>
<p>We can pass <code>data_sad</code> and <code>model</code> from the
previous steps to the data and model arguments, respectively, and run
the simulation for 100 <code>replicates</code>. The names of actual and
nominal time variables in <code>data_sad</code> match the default
arguments; however, our dependent variable is named <code>"ODV"</code>,
which must be specified in the output_vars argument. We would like to
recover the numerical variables <code>"DOSE"</code> and
<code>"FOOD"</code> and the character variable <code>"PART"</code> from
the input dataset, as we may need these study conditions to stratify our
VPC plots. We will request <code>"BLQ"</code> and <code>"LLOQ"</code>
for potential assessment of impact of censoring in the VPCs, as well as,
the NONMEM reserved variables <code>"CMT"</code>, <code>"EVID"</code>,
and <code>"MDV"</code>. Finally, we will add the argument
<code>obsonly = TRUE</code>, which is passed to <code><a href="https://rdrr.io/pkg/mrgsolve/man/mrgsim.html" class="external-link">mrgsim()</a></code>,
to remove dose records from the simulation output and reduce file
size.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mrgsim_vpc.html">mrgsim_vpc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sad</span>, </span>
<span>                     model <span class="op">=</span> <span class="va">model</span>, </span>
<span>                     replicates <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                     time_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="st">"TIME"</span>, NTIME <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span>,</span>
<span>                     output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PRED <span class="op">=</span> <span class="st">"PRED"</span>, IPRED <span class="op">=</span> <span class="st">"IPRED"</span>, DV <span class="op">=</span> <span class="st">"ODV"</span><span class="op">)</span>,</span>
<span>                     num_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CMT"</span>, <span class="st">"BLQ"</span>, <span class="st">"LLOQ"</span>, <span class="st">"EVID"</span>, <span class="st">"MDV"</span>, <span class="st">"DOSE"</span>, <span class="st">"FOOD"</span><span class="op">)</span>,</span>
<span>                     char_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PART"</span><span class="op">)</span>,</span>
<span>                     obsonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">simout</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 68,400</span></span>
<span><span class="co">#&gt; Columns: 21</span></span>
<span><span class="co">#&gt; $ ID     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, …</span></span>
<span><span class="co">#&gt; $ TIME   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00, 0.48, 0.81, 1.49, 2.11, 3.05, 4.14, 5.14, 7.81, 12.08, 16…</span></span>
<span><span class="co">#&gt; $ PRED   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000000, 1.0373644222, 2.4699025938, 5.8692716205, 8.67222…</span></span>
<span><span class="co">#&gt; $ IPRED  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000000, 0.23991271053, 0.58097762508, 1.44344928000, 2.2…</span></span>
<span><span class="co">#&gt; $ SIMDV  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000000, 0.2070745747, 0.6769646573, 1.8613297145, 1.74160…</span></span>
<span><span class="co">#&gt; $ OBSDV  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, 2.02, 4.02, 3.50, 7.18, 9.31, 12.46, 13.43, 12.11, 11.0…</span></span>
<span><span class="co">#&gt; $ EVID   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ CMT    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …</span></span>
<span><span class="co">#&gt; $ NTIME  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0, 0.5, 1.0, 1.5, 2.0, 3.0, 4.0, 5.0, 8.0, 12.0, 16.0, 24.0, …</span></span>
<span><span class="co">#&gt; $ BLQ    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, -1, 0…</span></span>
<span><span class="co">#&gt; $ LLOQ   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ MDV    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, …</span></span>
<span><span class="co">#&gt; $ DOSE   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10,…</span></span>
<span><span class="co">#&gt; $ FOOD   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</span></span>
<span><span class="co">#&gt; $ GUT    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000000000000, 4.34652773939926984, 4.13276198317304821, …</span></span>
<span><span class="co">#&gt; $ CENT   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.000000000000, 0.009786371098, 0.023698880423, 0.058880291437,…</span></span>
<span><span class="co">#&gt; $ PERIPH <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000000, 0.00080390625, 0.00337854545, 0.01621962833, 0.0…</span></span>
<span><span class="co">#&gt; $ TRANS1 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000000000000, 0.3188382667608536, 0.5115783540267899, 0.8…</span></span>
<span><span class="co">#&gt; $ TRANS2 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000000000, 0.01169414527583, 0.03166313774719, 0.0965661…</span></span>
<span><span class="co">#&gt; $ PART   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD", "Part 1-SAD", "Part 1-SAD", "Part 1-SAD", "Part 1…</span></span>
<span><span class="co">#&gt; $ SIM    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">simout</span><span class="op">$</span><span class="va">SIM</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100</span></span></code></pre></div>
<p>The maximum value of our replicate count variable (default =
<code>"SIM"</code>) indicates that the dataset has been replicated 100
times, as requested with the <code>replicates</code> argument.</p>
<p>Glimpsing the output from <code><a href="../reference/mrgsim_vpc.html">mrgsim_vpc()</a></code> reveals the
following model outputs:</p>
<ul>
<li>
<code>PRED</code> (population prediction)</li>
<li>
<code>IPRED</code> (individual prediction)</li>
<li>
<code>SIMDV</code> (simulated dependent variable)</li>
<li>
<code>OBSDV</code> (observed dependent variable).</li>
</ul>
<p>This simulated dataset is ready for either VPC or pcVPC plotting.
Under the hood, the function <code><a href="../reference/df_add_pred.html">df_add_pred()</a></code> is called to add
<code>PRED</code> to the simulation input dataset before running the
simulation for multiple iterations. This function can also be called to
add <code>PRED</code> to a dataset without running multiple
iterations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_sad_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df_add_pred.html">df_add_pred</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_sad</span>, model <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">data_sad_pred</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 720</span></span>
<span><span class="co">#&gt; Columns: 24</span></span>
<span><span class="co">#&gt; $ LINE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,…</span></span>
<span><span class="co">#&gt; $ ID      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,…</span></span>
<span><span class="co">#&gt; $ TIME    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00, 0.00, 0.48, 0.81, 1.49, 2.11, 3.05, 4.14, 5.14, 7.81, 12…</span></span>
<span><span class="co">#&gt; $ NTIME   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0, 0.0, 0.5, 1.0, 1.5, 2.0, 3.0, 4.0, 5.0, 8.0, 12.0, 16.0, …</span></span>
<span><span class="co">#&gt; $ NDAY    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 3, 4, 5, 6, 7, 8, 1,…</span></span>
<span><span class="co">#&gt; $ DOSE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10…</span></span>
<span><span class="co">#&gt; $ AMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, 10, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></span>
<span><span class="co">#&gt; $ EVID    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span></span>
<span><span class="co">#&gt; $ ODV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, 2.02, 4.02, 3.50, 7.18, 9.31, 12.46, 13.43, 12.11,…</span></span>
<span><span class="co">#&gt; $ LDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> NA, NA, NA, 0.7031, 1.3913, 1.2528, 1.9713, 2.2311, 2.5225, 2.…</span></span>
<span><span class="co">#&gt; $ CMT     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,…</span></span>
<span><span class="co">#&gt; $ MDV     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, NA, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ BLQ     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1, NA, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">#&gt; $ LLOQ    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, NA, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</span></span>
<span><span class="co">#&gt; $ FOOD    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</span></span>
<span><span class="co">#&gt; $ SEXF    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…</span></span>
<span><span class="co">#&gt; $ RACE    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1,…</span></span>
<span><span class="co">#&gt; $ AGEBL   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25…</span></span>
<span><span class="co">#&gt; $ WTBL    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82.1, 82…</span></span>
<span><span class="co">#&gt; $ SCRBL   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.87, 0.…</span></span>
<span><span class="co">#&gt; $ CRCLBL  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 128, 12…</span></span>
<span><span class="co">#&gt; $ USUBJID <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "STUDYNUM-SITENUM-1", "STUDYNUM-SITENUM-1", "STUDYNUM-SITENUM-…</span></span>
<span><span class="co">#&gt; $ PART    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Part 1-SAD", "Part 1-SAD", "Part 1-SAD", "Part 1-SAD", "Part …</span></span>
<span><span class="co">#&gt; $ PRED    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000000, 0.0000000000, 1.0373644222, 2.4699025938, 5.8692…</span></span></code></pre></div>
<p>Okay, so now we have run the vpc simulation and generated an output
dataset (<code>simout</code>) ready to be processed for plotting. The
<code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc::vpc()</a></code>function offers a lot of great functionality to
generate VPC plots, including both the data processing and plotting
steps in one function call. However, although <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code>
contains many great options to automatically identify bins in the data,
it is NOT optimized for input data containing exact bins.</p>
<p>The documentation for <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> (<a href="https://vpc.ronkeizer.com/binning.html" class="external-link uri">https://vpc.ronkeizer.com/binning.html</a>) describes the
following binning methods:</p>
<ul>
<li>
<code>time</code>: Divide bins equally over time (or whatever
independent variable is used). Recommended only when there is no
observable clustering in the independent variable.</li>
<li>
<code>data</code>: Divide bins equally over the amount of data
ordered by independent variable. Recommended only when data are for
nominal timepoints and all datapoints are available.</li>
<li>
<code>density</code>: Divide bins based on data-density, i.e. place
the bin-separators at nadirs in the density function. An approximate
number of bins can be specified, but it is not certain that the
algorithm will strictly use the specified number. More info in
<code>?auto_bin()</code>.</li>
<li>
<code>jenks</code>: Default and recommended method. Jenk’s natural
breaks optimization, similar to K-means clustering.</li>
<li>
<code>kmeans</code>: K-means clustering.</li>
<li>
<code>pretty</code>, <code>quantile</code>, <code>hclust</code>,
<code>sd</code>, <code>bclust</code>, <code>fisher</code>. Methods
provided by the classInt package, see the package help for more
information.</li>
</ul>
<p>We can visualize the bins assigned by the various binning approaches
in <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> using by assigning the plot as an R object and
calling <code>plot_object$data</code>.</p>
<p>Because we have multiple dose levels in the SAD portion of the study,
as well as, a food effect cohort, prediction correction will be used to
plot all the data on a single plot using the argument
<code>pred_corr = TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_jenks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="st">"jenks"</span>, <span class="co">#default</span></span>
<span>  n_bins <span class="op">=</span> <span class="st">"auto"</span>, </span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vpc_jenks</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-jenks-1.png" width="576"></p>
<p>This plot looks pretty good! The default binning in
<code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc::vpc()</a></code> produce a very nice looking plot. However, all
of the binning methods internal to <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> are designed to
determine binning intervals from the actual data. Currently, there is no
method to use <em>exact bins contained in the data</em> in place of
<em>bin intervals determined from the data</em>. The presence of exact
bins in the data is a common scenario in pharmacometrics, as Clinical
Study Protocols usually specify specific Study Visits corresponding ot
each sample, which are associated with a nominal (protocolized) time of
collection.</p>
<p>We can use the <code><a href="../reference/nobs_bin.html">nobs_bin()</a></code> function to calculate and
return a summary data.frame containing the unique exact bin times, count
of non-missing observations (EVID=0 &amp; MDV=0), and count of missing
(EVID=0 &amp; MDV=1) observations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Exact bins in the input data</span></span>
<span><span class="fu"><a href="../reference/nobs_bin.html">nobs_bin</a></span><span class="op">(</span><span class="va">data_sad</span>, bin_var <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    NTIME   CMT n_obs n_miss</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0       2     0     36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5     2    34      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   1       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   1.5     2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   2       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   3       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   4       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   5       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   8       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  16       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  24       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  36       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  48       2    33      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  72       2    29      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  96       2    16     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 120       2     6     30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 144       2     1     35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 168       2     0     36</span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc() using bins = "jenks"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_jenks</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;    strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        1.01     0.5       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1        3        2         5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1        5        5         8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1       10        8        16</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1       16       16        24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1       24       24        36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1       36       36        48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1       48       48        72</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1       72       72        96</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1       96       96       120</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 1      123.     120       144</span></span></code></pre></div>
<p>The <code>bin_mid</code> variable is where<code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> will
plot the summary statistics calculated for the observed and simulated
data.</p>
<p>We can clearly see that the default <code>bins = "jenks"</code>
method does not reproduce the exact bins in the observed dataset,
<em>even when passing nominal, rather than actual, time as the
independent variable (<code>idv</code>)</em>. How about the other
binning methods native to <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code>? Let’s take a look at
<code>bins = "pretty"</code> next.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_pretty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="st">"pretty"</span>, </span>
<span>  n_bins <span class="op">=</span> <span class="st">"auto"</span>, </span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vpc_pretty</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-pretty-1.png" width="576"></p>
<p>The vpc plot produced with <code>bins = "pretty</code> <em>is</em>
fairly pretty; however, again we can see that the binning is not true to
the exact bins in our dataset, especially at the earlier absorption
phase time-points, which are being largely binned together.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Exact bins in the input data</span></span>
<span><span class="fu"><a href="../reference/nobs_bin.html">nobs_bin</a></span><span class="op">(</span><span class="va">data_sad</span>, bin_var <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    NTIME   CMT n_obs n_miss</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0       2     0     36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5     2    34      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   1       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   1.5     2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   2       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   3       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   4       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   5       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   8       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  16       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  24       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  36       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  48       2    33      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  72       2    29      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  96       2    16     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 120       2     6     30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 144       2     1     35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 168       2     0     36</span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc() using bins = "pretty"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_pretty</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;   strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1        3.14       0      10</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       14         10      20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       24         20      30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1       36         30      40</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1       48         40      50</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1       72         70      80</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 1       96         90     100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 1      120        120     130</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> 1      144        140     150</span></span></code></pre></div>
<p>The <code>bins = "kmeans"</code> option produces yet another
reasonably visually appealing plot; however, like
<code>bins = "pretty"</code> it groups many of the absorption phase
timepoints together and does not include the last three sampling times
with quantifiable observations in simulated intervals.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_kmeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="st">"kmeans"</span>, </span>
<span>  n_bins <span class="op">=</span> <span class="st">"auto"</span>, </span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vpc_kmeans</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-kmeans-1.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Exact bins in the input data</span></span>
<span><span class="fu"><a href="../reference/nobs_bin.html">nobs_bin</a></span><span class="op">(</span><span class="va">data_sad</span>, bin_var <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    NTIME   CMT n_obs n_miss</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0       2     0     36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5     2    34      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   1       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   1.5     2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   2       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   3       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   4       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   5       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   8       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  16       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  24       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  36       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  48       2    33      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  72       2    29      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  96       2    16     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 120       2     6     30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 144       2     1     35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 168       2     0     36</span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc() using bins = "kmeans"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_kmeans</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;    strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         0.5    0.5     0.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         1      0.75    1.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         1.5    1.25    1.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1         2      1.75    2.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1         3      2.5     3.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1         4.5    3.5     6.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1        10      6.5    14   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1        20     14      30   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1        41.7   30      60   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1        72     60      84   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 1       104.    84     144</span></span></code></pre></div>
<p>The native binning methods <code>density</code> attempts to bin the
data by finding the nadir in the density function. In this case, we can
try and inform the binning algorithm on how many bins we <em>expect</em>
in the data. Let’s pass the length of the vector of unique
<code>NTIME</code> values in our dataset to the <code>n_bins</code>
argument and see if the <code>density</code> approach can find the
correct bins.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="st">"density"</span>, </span>
<span>  n_bins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simout</span><span class="op">$</span><span class="va">NTIME</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vpc_density</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-density-1.png" width="576"></p>
<p>Whomp Whomp. <code>bins = "density"</code>, like the previous methods
evaluated, grouped most of the absorption phase into a single bin.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Exact bins in the input data</span></span>
<span><span class="fu"><a href="../reference/nobs_bin.html">nobs_bin</a></span><span class="op">(</span><span class="va">data_sad</span>, bin_var <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    NTIME   CMT n_obs n_miss</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0       2     0     36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5     2    34      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   1       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   1.5     2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   2       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   3       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   4       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   5       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   8       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  16       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  24       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  36       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  48       2    33      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  72       2    29      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  96       2    16     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 120       2     6     30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 144       2     1     35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 168       2     0     36</span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc() using bins = "density"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_density</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;    strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1        3.14     0      10.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1       12       10.2    14.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1       16       14.4    20.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1       24       20.3    30.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1       36       30.4    42.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1       48       42.3    60.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1       72       60.2    84.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1       96       84.3   108. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1      120      108.    133. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1      144      133.    145.</span></span></code></pre></div>
<p>This leaves us with two methods that divide the data equally into
bins over the range of values in the data: <code>bins = "data"</code>
(equal data density in each bin) and <code>bins = "time"</code> (equal
bin width in time).</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="st">"data"</span>, </span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vpc_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="st">"time"</span>, </span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vpc_data</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-data-time-1.png" width="576"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_time</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-data-time-2.png" width="576"></p>
<p>These methods are designed to equalize data density in each bin,
which unsurprisingly does not produce binning consistent with the exact
bins in our dataset.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Exact bins in the input data</span></span>
<span><span class="fu"><a href="../reference/nobs_bin.html">nobs_bin</a></span><span class="op">(</span><span class="va">data_sad</span>, bin_var <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    NTIME   CMT n_obs n_miss</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0       2     0     36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5     2    34      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   1       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   1.5     2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   2       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   3       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   4       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   5       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   8       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  16       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  24       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  36       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  48       2    33      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  72       2    29      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  96       2    16     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 120       2     6     30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 144       2     1     35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 168       2     0     36</span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc() using bins = "data"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_data</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;   strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1        1.25       1      2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1        2          2      3 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1        3.5        3      5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1        6.5        5     12 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1       12         12     16 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1       20         16     36 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 1       36         36     48 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 1       71.4       48    144.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> 1        0.5       <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span></span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc() using bins = "time"</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_time</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;   strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1        5.33   0.357    16.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1       24     16.4      32.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1       41.7   32.4      48.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1       72     64.3      80.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 1       96     80.2      96.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1      120    112       128  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 1      144    128       144.</span></span></code></pre></div>
<p>The pmxhelpr function <code><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins()</a></code> is a wrapper
function for <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> which is optimized for input datasets
containing exact bins. This wrapper passes the the unique exact bins
(e.g., Nominal Times) in the input dataset as bin boundaries with the
addition of <code>Inf</code> to the end of the vector to ensure that the
final exact bin is included, rather than set only as a bin boundary.
This functionality can be reproduced using <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> by passing
a vector of unique exact bins to <code>bins</code> with the addition of
<code>Inf</code> as follows:</p>
<ul>
<li><code>bins = c(sort(unique(simout$NTIME)), Inf)</code></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exact_bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">simout</span><span class="op">$</span><span class="va">NTIME</span><span class="op">)</span><span class="op">)</span>, <span class="cn">Inf</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vpc_exact_ntime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  obs <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">simout</span>, <span class="va">SIM</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, </span>
<span>  bins <span class="op">=</span> <span class="va">exact_bins</span>,</span>
<span>  sim_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"SIMDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  obs_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dv <span class="op">=</span> <span class="st">"OBSDV"</span>, idv <span class="op">=</span> <span class="st">"NTIME"</span>, pred <span class="op">=</span> <span class="st">"PRED"</span><span class="op">)</span>,</span>
<span>  pred_corr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs_dv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vpc_exact_ntime</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-vpc-exact-1.png" width="576"></p>
<p>However, this workaround will only work if the idv is set to the
nominal time variable (<code>idv = "NTIME</code>) in both the
<code>sim_cols</code> and <code>obs_cols</code> arguments, which
precludes us from plotting the actual observed data points by actual
time (<code>"TIME"</code>) while binned summary statistics are
calculated based on the exact bins defined by nominal time
(<code>NTIME</code>). <code><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins()</a></code> gets around this
limitation by plotting the observed data in a separate layer on top of
the plot object returned by <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code>, including
prediction-correction of those observed points if
<code>pcvpc = TRUE</code> (also passed along to the
<code>pred_corr</code> argument of <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code>)</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_exact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  pcvpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="st">"TIME"</span>, NTIME <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span>,</span>
<span>  output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PRED <span class="op">=</span> <span class="st">"PRED"</span>, IPRED <span class="op">=</span> <span class="st">"IPRED"</span>, SIMDV <span class="op">=</span> <span class="st">"SIMDV"</span>, OBSDV <span class="op">=</span> <span class="st">"OBSDV"</span><span class="op">)</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vpc_exact</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-exact-1.png" width="576"></p>
<p>The difference in plotting the observed prediction-corrected data
points by <code>"TIME"</code> versus <code>"NTIME"</code> is negligible
for this example dataset, due to the high concordance between
<code>"TIME"</code> and <code>"NTIME"</code> in this well controlled
example Phase 1 study. However, this difference is often much larger for
pooled analyses including later phase clinical studies where plotting
the observed points versus actual time will result in a plot that is
much more representative of the distribution of times in the model
training dataset.</p>
<p>When exploring the bins in the input and output datasets using
<code>plot_vpc_exactbins()</code>, we now can see that they are
consistent! Huzzah!</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Exact bins in the input data</span></span>
<span><span class="fu"><a href="../reference/nobs_bin.html">nobs_bin</a></span><span class="op">(</span><span class="va">data_sad</span>, bin_var <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    NTIME   CMT n_obs n_miss</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   0       2     0     36</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   0.5     2    34      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   1       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   1.5     2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   2       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   3       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   4       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   5       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   8       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  12       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>  16       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>  24       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>  36       2    36      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>  48       2    33      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>  72       2    29      7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>  96       2    16     20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 120       2     6     30</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 144       2     1     35</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 168       2     0     36</span></span>
<span></span>
<span><span class="co">##Bin midpoints and boundaries determined by vpc_plot_exactbins()</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">vpc_exact</span><span class="op">$</span><span class="va">data</span>, <span class="va">bin_mid</span>, <span class="va">bin_min</span>, <span class="va">bin_max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Adding missing grouping variables: `strat`</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 17 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   strat [1]</span></span></span>
<span><span class="co">#&gt;    strat bin_mid bin_min bin_max</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         0.5     0.5     1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1         1       1       1.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1         1.5     1.5     2  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1         2       2       3  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1         3       3       4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1         4       4       5  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1         5       5       8  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1         8       8      12  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1        12      12      16  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1        16      16      24  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 1        24      24      36  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 1        36      36      48  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 1        48      48      72  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1        72      72      96  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 1        96      96     120  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 1       120     120     144  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 1       144     144     <span style="color: #BB0000;">Inf</span></span></span></code></pre></div>
<p><code><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins()</a></code> also contains an argument built
around a function we introduced earlier (<code><a href="../reference/nobs_bin.html">nobs_bin()</a></code>). The
argument <code>min_bin_count</code> (default = 1) filters out exact bins
with fewer quantifiable observations than the minimum set by this
argument. Importantly, the observed data points in these small bins are
<em>still plotted</em>; however, they do not influence the calculation
of summary statistics or summary plot elements (shaded intervals,
lines). This provides the greatest fidelity to the data being analyzed
without introducing visual artifacts due to small sample timepoints.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_exact_bin_gt10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="va">simout</span>, </span>
<span>  pcvpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="st">"TIME"</span>, NTIME <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span>,</span>
<span>  output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PRED <span class="op">=</span> <span class="st">"PRED"</span>, IPRED <span class="op">=</span> <span class="st">"IPRED"</span>, SIMDV <span class="op">=</span> <span class="st">"SIMDV"</span>, OBSDV <span class="op">=</span> <span class="st">"OBSDV"</span><span class="op">)</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  min_bin_count <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vpc_exact_bin_gt10</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/plot-exact-min-bin-count-1.png" width="576"></p>
<p>When setting<code>min_bin_count = 10</code>, summary statistics are
not plotted for the final two timepoint containing only fewer than 10
quantifiable observations; however, the observations themselves are
still plotted.</p>
<p>We can also pass stratifying variables to the argument
<code>strat_vars</code> in order to facet our plots by relevant
extrinsic study design covariates or intrinsic subject covariates. The
stratify variables specified in <code>strat_vars</code> are also passed
to the <code>stratify</code> argument of <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc()</a></code> in order to
facet the resulting plots. Currently, only up to two variables can be
passed to this argument.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vpc_exact_food</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vpc_plot_exactbins.html">vpc_plot_exactbins</a></span><span class="op">(</span></span>
<span>  sim <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">simout</span>, FOOD_f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">FOOD</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fasted"</span>, <span class="st">"Fed"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  strat_vars <span class="op">=</span> <span class="st">"FOOD_f"</span>,</span>
<span>  pcvpc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  time_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>TIME <span class="op">=</span> <span class="st">"TIME"</span>, NTIME <span class="op">=</span> <span class="st">"NTIME"</span><span class="op">)</span>,</span>
<span>  output_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PRED <span class="op">=</span> <span class="st">"PRED"</span>, IPRED <span class="op">=</span> <span class="st">"IPRED"</span>, SIMDV <span class="op">=</span> <span class="st">"SIMDV"</span>, OBSDV <span class="op">=</span> <span class="st">"OBSDV"</span><span class="op">)</span>,</span>
<span>  pi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  log_y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vpc_exact_food</span></span></code></pre></div>
<p><img src="vpc-exact-bins_files/figure-html/r%20plot-exact-min-bin-count-1.png" width="576"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Crass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
