<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Helper Functions for Pharmacometrics â€¢ pmxhelpr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Helper Functions for Pharmacometrics">
<meta name="description" content="Wrapper functions for mrgsolve and vpc package functions and other general helpers to make pharmacometrics workflows more seamless.">
<meta property="og:description" content="Wrapper functions for mrgsolve and vpc package functions and other general helpers to make pharmacometrics workflows more seamless.">
<meta property="og:image" content="https://ryancrass.github.io/pmxhelpr/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">pmxhelpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4.9008</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/eda-pmxhelpr.html">Exploratory Data Analysis</a></li>
    <li><a class="dropdown-item" href="articles/vpc-exact-bins.html">VPC Plots with Exact Bins</a></li>
    <li><a class="dropdown-item" href="articles/vpc-obs-quant-blq-cens.html">VPC Plots with BLQ Censoring</a></li>
    <li><a class="dropdown-item" href="articles/vpc-plot-aesthetics.html">VPC Plot Aesthetics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ryancrass/pmxhelpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="pmxhelpr-">pmxhelpr 
<a class="anchor" aria-label="anchor" href="#pmxhelpr-"></a>
</h1>
</div>
<!-- badges: start -->

<p>The goal of pmxhelpr is to make pharmacometrics workflows more standardized, efficient, and reproducible. This package provides helper and wrapper functions for common steps in the pharmacometrics analysis workflow, such as exploratory data analysis, model development, model evaluation, and model application.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of pmxhelpr from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ryancrass/pmxhelpr"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="function-naming-conventions">Function Naming Conventions<a class="anchor" aria-label="anchor" href="#function-naming-conventions"></a>
</h2>
<p>Functions in this package use the following naming conventions:</p>
<ul>
<li>Wrapper functions: <em>ReturnObject</em>_<em>WrappedFunction</em>_<em>Purpose</em>
<ul>
<li>
<code><a href="reference/model_mread_load.html">model_mread_load()</a></code> wraps <code><a href="https://mrgsolve.org/docs/reference/mread.html" class="external-link">mrgsolve::mread_cache()</a></code> to read internal package model files returning an <code>mrgmod</code> object.</li>
<li>
<code>df_mrgsim_addpred()</code> wraps <code><a href="https://mrgsolve.org/docs/reference/mrgsim.html" class="external-link">mrgsolve::mrgsim()</a></code> including <code><a href="https://mrgsolve.org/docs/reference/zero_re.html" class="external-link">mrgsolve::zero_re()</a></code> to add population predictions (PRED) to the input data returning a <code>data.frame</code>.</li>
<li>
<code><a href="reference/df_mrgsim_replicate.html">df_mrgsim_replicate()</a></code> wraps <code><a href="https://mrgsolve.org/docs/reference/mrgsim.html" class="external-link">mrgsolve::mrgsim()</a></code> to replicate the input data returning a <code>data.frame</code>.</li>
<li>
<code><a href="reference/plot_vpc_exactbins.html">plot_vpc_exactbins()</a></code> wraps <code><a href="https://rdrr.io/pkg/vpc/man/vpc.html" class="external-link">vpc::vpc()</a></code> to generate a VPC plot using exact time bins returning a <code>ggplot</code> object.</li>
</ul>
</li>
<li>Helper functions: <em>ReturnObject</em>_<em>Purpose</em>
<ul>
<li>
<code>plot_dvtime</code> returns a <code>ggplot</code> object with a dependent variable plotted versus time</li>
<li>
<code>df_nobsbin</code> returns a summary <code>data.frame</code> with counts of the number of missing and non-missing observations per bin.</li>
<li>
<code>df_pcdv</code> returns a <code>data.frame</code> containing the prediction-corrected dependent variable.</li>
<li>
<code>plot_legend</code> returns a <code>ggplot</code> object containing a legend for a VPC plot generated using <code>plot_vpc_exactbins</code>
</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="example-visual-predictive-check-workflow">Example Visual Predictive Check Workflow<a class="anchor" aria-label="anchor" href="#example-visual-predictive-check-workflow"></a>
</h2>
<p>This is a basic example which illustrates a simple VPC workflow using pmxhelpr:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(pmxhelpr)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">library</span>(mrgsolve)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">library</span>(vpc)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">library</span>(withr)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#Read internal analysis-ready dataset for an example Phase 1 study</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">glimpse</span>(data_sad)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#Plot data</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>data <span class="ot">&lt;-</span> data_sad</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dose =</span> <span class="fu">paste</span>(DOSE, <span class="st">"mg"</span>), </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>         <span class="at">Dose_f =</span> <span class="fu">factor</span>(Dose, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"10 mg"</span>, <span class="st">"50 mg"</span>, <span class="st">"100 mg"</span>, <span class="st">"200 mg"</span>, <span class="st">"400 mg"</span>)))</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>         </span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">plot_dvtime</span>(<span class="at">data =</span> data, <span class="at">dv_var =</span> <span class="fu">c</span>(<span class="at">DV =</span> <span class="st">"ODV"</span>), <span class="at">cent =</span> <span class="st">"median"</span>, <span class="at">col_var =</span> <span class="st">"Dose_f"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>            <span class="at">ylab =</span> <span class="st">"Concentration (ng/mL)"</span>, <span class="at">timeu =</span> <span class="st">"hours"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#Read internal mrgsolve model file</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">model_mread_load</span>(<span class="st">"model"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#Simulated replicates of the dataset using mrgsim </span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>simout <span class="ot">&lt;-</span> <span class="fu">df_mrgsim_replicate</span>(<span class="at">data =</span> data, <span class="at">model =</span> model,<span class="at">replicates =</span> <span class="dv">100</span>,</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>                              <span class="at">output_vars =</span> <span class="fu">c</span>(<span class="at">DV =</span> <span class="st">"ODV"</span>),</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>                              <span class="at">num_vars =</span> <span class="fu">c</span>(<span class="st">"CMT"</span>, <span class="st">"LLOQ"</span>, <span class="st">"EVID"</span>, <span class="st">"MDV"</span>, <span class="st">"WTBL"</span>, <span class="st">"FOOD"</span>),</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>                              <span class="at">char_vars =</span> <span class="fu">c</span>(<span class="st">"USUBJID"</span>, <span class="st">"PART"</span>, <span class="st">"Dose_f))</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="st">glimpse(simout)</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="st">#Plot output in a Prediction-corrected Visual Predictive Check (VPC)</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="st">  #Exact nominal time bins present in data_sad ("</span>NTIME<span class="st">") are used to plot summary statistics</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="st">  #Actual time ("</span>TIME<span class="st">") is used to plot observed data points, which are also prediction-corrected if pcvpc=TRUE</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="st">  #LLOQ in the dataset is 1 ng/mL</span></span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="st">plot_obj_food &lt;- plot_vpc_exactbins(</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a><span class="st">  sim = mutate(simout, FOOD_f = factor(FOOD, levels = c(0,1), labels = c("</span>Fasted<span class="st">", "</span>Fed<span class="st">"))), </span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a><span class="st">  strat_vars = "</span>FOOD_f<span class="st">",</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a><span class="st">  pcvpc = TRUE,</span></span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a><span class="st">  time_vars = c(TIME = "</span>TIME<span class="st">", NTIME = "</span>NTIME<span class="st">"),</span></span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a><span class="st">  output_vars = c(PRED = "</span>PRED<span class="st">", IPRED = "</span>IPRED<span class="st">", SIMDV = "</span>SIMDV<span class="st">", OBSDV = "</span>OBSDV<span class="st">"),</span></span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a><span class="st">  pi = c(0.05, 0.95),</span></span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a><span class="st">  ci = c(0.05, 0.95),</span></span>
<span id="cb2-43"><a href="#cb2-43" tabindex="-1"></a><span class="st">  log_y = TRUE</span></span>
<span id="cb2-44"><a href="#cb2-44" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb2-45"><a href="#cb2-45" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" tabindex="-1"></a><span class="st">plot_obj_food</span></span>
<span id="cb2-47"><a href="#cb2-47" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" tabindex="-1"></a><span class="st">#Add Legend</span></span>
<span id="cb2-49"><a href="#cb2-49" tabindex="-1"></a><span class="st">plot_obj_leg &lt;- plot_legend(pi = c(0.05, 0.95), ci = c(0.05, 0.95))</span></span>
<span id="cb2-50"><a href="#cb2-50" tabindex="-1"></a><span class="st">plot_obj_leg</span></span>
<span id="cb2-51"><a href="#cb2-51" tabindex="-1"></a></span>
<span id="cb2-52"><a href="#cb2-52" tabindex="-1"></a><span class="st">plot_obj_food_wleg &lt;- plot_obj_food + plot_obj_leg + plot_layout(heights = c(2,1))</span></span>
<span id="cb2-53"><a href="#cb2-53" tabindex="-1"></a><span class="st">plot_obj_food_wleg</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ryancrass/pmxhelpr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ryancrass/pmxhelpr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pmxhelpr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ryan Crass <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0001-5403-4730" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ryancrass/pmxhelpr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/ryancrass/pmxhelpr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ryan Crass.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
